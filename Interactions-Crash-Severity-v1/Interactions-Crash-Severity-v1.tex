\documentclass[]{elsarticle} %review=doublespace preprint=single 5p=2 column
%%% Begin My package additions %%%%%%%%%%%%%%%%%%%
\usepackage[hyphens]{url}

  \journal{Some Journal} % Sets Journal name


\usepackage{lineno} % add
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\usepackage{graphicx}
\usepackage{booktabs} % book-quality tables
%%%%%%%%%%%%%%%% end my additions to header

\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \usepackage{fontspec}
  \ifxetex
    \usepackage{xltxtra,xunicode}
  \fi
  \defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
  \newcommand{\euro}{â‚¬}
\fi
% use microtype if available
\IfFileExists{microtype.sty}{\usepackage{microtype}}{}
\bibliographystyle{elsarticle-harv}
\ifxetex
  \usepackage[setpagesize=false, % page size defined by xetex
              unicode=false, % unicode breaks when used with xetex
              xetex]{hyperref}
\else
  \usepackage[unicode=true]{hyperref}
\fi
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={},
            pdftitle={An empirical assessment of strategies to model opponent effects in crash severity analysis},
            colorlinks=false,
            urlcolor=blue,
            linkcolor=magenta,
            pdfborder={0 0 0}}
\urlstyle{same}  % don't use monospace font for urls

\setcounter{secnumdepth}{5}
% Pandoc toggle for numbering sections (defaults to be off)


% Pandoc header
\usepackage[margin=1in]{geometry}
\usepackage{lineno}
\linenumbers
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}



\begin{document}
\begin{frontmatter}

  \title{An empirical assessment of strategies to model opponent effects in crash
severity analysis}
    \author[]{Antonio Paez\corref{Corresponding Author}}
   \ead{paezha@mcmaster.ca} 
    \author[Louisiana State University]{Hany Hassan}
   \ead{hassan1@lsu.edu} 
    \author[McMaster University]{Mark Ferguson}
   \ead{fergumr@mcmaster.ca} 
    \author[McMaster University]{Saiedeh Razavi}
   \ead{razavi@mcmaster.ca} 
      \address[McMaster University]{McMaster Institute for Transportation and Logistics, 1280 Main Street
West, Hamilton, Ontario, Canada L8S 4K1}
    \address[Louisiana State University]{Department of Civil and Environmental Engineering, Baton Rouge,
Louisiana, USA 70803}
    
  \begin{abstract}
  Road accidents impose an important burden on health and the economy.
  Numerous efforts to understand the factors that affect road collisions
  have been undertaken. One stream of research focus on modelling the
  severity of crashes. Crash severity research is useful to clarify the
  way different factors can influence the outcome of the event. The
  objective of this paper is to assess different strategies to model the
  interactions between participants in a crash, in the context of crashes
  involving two parties. Towards this objective, a series of models are
  estimated using data from Canada's National Collision Database. Three
  levels of crash severity (no injury/injury/fatality) are analyzed using
  ordered logit models and covariates for the participants in the crash
  and the conditions of the crash. Modelling strategies include different
  ways of introducing the covariates (e.g., in a single-level or
  multi-level form), as well as by subsetting the dataset. The models are
  assessed using predicted shares and outcomes, and the results highlight
  the importance of considering opponent effects in crash severity
  analysis. On the other hand, the study suggests that hierarchical (i.e.,
  multi-level) specifications and subsetting do not perform necessarily
  better than a relatively simple single-level model with opponent
  effects.
  \end{abstract}
  
 \end{frontmatter}

\hypertarget{introduction}{%
\section{Introduction}\label{introduction}}

Road safety continues to be a world-wide concern. According to a recent
report from the World Health Organization (2019), road accidents are the
8th leading cause of death for all ages, and the number one cause of
death for children and young people between the ages of 5 to 29. Of all
leading causes of death, road accidents are the only cause of death
unrelated to disease, disorder, or infection. Road accidents impose a
heavy burden on individuals and society as a whole. Gobally, the rate of
road collision-related deaths per 100,000 population and 100,000
vehicles have both fallen, even as the number of vehicles has grown
(World Health Organization, 2019, Figs. 1 and 2). These gains, although
they are to be celebrated, cannot distract from the crushing economic
cost of premature death (e.g., Symons et al., 2019; Wijnen et al.,
2019), not to mention the long-term consequences for survivors, measured
in sometimes crippling emotional and physical pain (e.g., Merlin et al.,
2007; Devlin et al., 2019; Pelissier et al., n.d.).

Evidence from across the world suggests that the burden of road
accidents is not borne evenly. There are important disparities at the
international level, where the odds of death due to road crashes are
three times higher in low-income countries compared to high-income
countries; in fact, no reductions in road accident-related fatalities
were appreciated in low-income countries between 2013 and 2016 (World
Health Organization, 2019). In the case of high-income countries, where
substantial gains in road safety have been observed for years, said
gains have also been unevenly distributed; thus, while fatal crashes
involving older adults in the United States and Great Britain declined
between 1997 and 2010 (despite the graying of the population), the trend
remained stable or increased slightly in Australia in roughly the same
period (Thompson et al., 2018). There are also systematic differences in
the impact of road accidents. For example, in a study in the United
States, Obeng (2011) reported that the impact of covariates of crash
severity varied substantially in magnitude by gender. More recently,
Regev et al.~(2018) used adjusted crash risk to find that the risk of
crashes in Great Britain peaked for people 21 to 29 years of age; on the
other hand, the risk of fatal injuries for older drivers was constant,
irrespective of the seriousness of the crash - which highlights the
perils of accidents at older ages. Other studies have concentrated on
the consequences of road accidents for the young (e.g., Peek-Asa et al.,
2010), the old (e.g., Rakotonirainy et al., 2012), as well as
pedestrians and cyclists (e.g., Hanson et al., 2013; McArthur et al.,
2014).

Given the relevance and cost of this matter, as well as the important
variations of the impacts among different population segments, numerous
efforts efforts have been conducted to better understand the factors
that affect road safety - including the probable consequences of
crashes. Consequently, a stream of research in the analysis of road
accidents is concerned with the severity of crashes. In particular,
multivariate analysis of crash severity is a useful way to clarify the
way various factors can affect the outcome of an incident, to
discriminate between various levels of injury, from no injury (i.e.,
property damage only), to different degrees of injury up to and
including fatality. This is an active area of research (e.g., Savolainen
et al., 2011), and one where methodological developments have aimed at
improving the reliability, accuracy, and precision of models.

This paper aspires to contribute to the literature on crash severity by
assessing different modelling strategies useful to incorporate opponent
effects in crash analysis, in the context of incidents involving two
parties. The importance of these interactions has been recognized in the
existing literature (e.g., Chiou et al., 2013; Lee and Li, 2014; Li et
al., 2017; Tarrao et al., 2014), and a number of different modelling
strategies have been proposed. In this paper we present a systematic
assessment of several relevant modelling strategies, ranging from the
way variables are defined in single-level models, in multi-level models
(i.e., hierarchical models), as well as using data subsetting
approaches. For the assessment we use data from Canada's National
Collision Database, a database that collects all police-reported
collisions in the country. Using the most recent version of the dataset
(2017), three levels of crash severity (no injury/injury/fatality) are
analyzed using ordered logit models and covariates for the participants
in the crash and the conditions of the crash. For model assessment, we
conduct an in-sample prediction exercise using the estimation sample
(i.e., \emph{nowcasting}), and also an out-of-sample prediction exercise
using the dataset corresponding to 2016 (i.e., \emph{backcasting}). The
models are assessed using predicted shares and predicted individual
outcomes using an extensive array of verification statistics. The
results highlight the importance of considering opponent effects in
crash severity analysis to improve the goodness-of-fit and predictive
performance o. On the other hand, the study suggests that hierarchical
variable specifications and subsetting do not perform necessarily better
than a relatively simple single-level model with opponent effects.

The rest of this paper is structured as follows. In Section
\ref{sec:review-of-methods} we present a concise review of the methods
used to analyze crash severity, with a particular focus on techniques
that consider the interactions between participants in a crash. Section
\ref{sec:application} describes the data requirements, data
preprocessing, and the modelling strategy, along with the results of
model estimation. The results of assessing the models and the discussion
of these results is found in Section \ref{sec:assessment}. We then
present some additional thoughts about the applicability of this
approach in Section \ref{sec:further-considerations} before offering
some concluding remarks in Section \ref{sec:concluding-remarks}.

\hypertarget{sec:review-of-methods}{%
\section{Methodological approaches in crash severity
analysis}\label{sec:review-of-methods}}

\hypertarget{general-considerations}{%
\subsection{General considerations}\label{general-considerations}}

Modelling the outcomes of crashes in terms of the severity of injuries
to participants has been a preoccupation of transportation researchers,
planners, auto insurance companies, governments and the public for
decades. One of the earliests studies to investigate the severity of
injuries conditional on an accident having occurred was by White and
Clayton (1972). Kim et al.~(1995) later stated that the ``linkages
between severity of injury and driver characteristics and behaviors have
not been thoroughly investigated'' (p.~470). Nowadays, there is a
burgeoning literature on this subject, including methodological
developments, case studies, and more niche research with a focus on
particular situations (e.g., crashes at intersections, Mussone et al.,
2017; crashes in rural roads, Gong and Fan, 2017) or special populations
(e.g., crashes involving motorcyclists or active travelers; see Shaheed
et al., 2013; Salon and McIntyre, 2018).

Crash severity is often modelled using models for discrete outcomes,
including classification techniques from machine learning (e.g.,
Iranitalab and Khattak, 2017; Chang and Wang, 2006; Effati et al., 2015;
Khan et al., 2015), Poisson models for counts (e.g., Ma et al., 2008),
unordered logit/probit models (e.g., Tay et al., 2011), as well as
ordered logit/probit models (e.g., Rifaat and Chin, 2007), with numerous
variants, such as random parameters/mixed logit (e.g., Aziz et al.,
2013; Haleem and Gan, 2013), partial proportional odds models (e.g.,
Mooradian et al., 2013; Sasidharan and Menendez, 2014), and the use of
copulas (e.g., Wang et al., 2015). Recent reviews of methods include
Savolainen et al.~(2011) and Shamsunnahar and Eluru (2013).

Irrespective of the modelling framework employed, models of crash
severity often include variables in several categories, as shown with
examples in Table \ref{tab:variable-categories} (also see Montella et
al., 2013). Many crash databases and analyses also account for the
multievent nature of many crashes. Participants may have had different
roles in a crash depending on their context, with some acting as
operators of a vehicle (i.e., drivers, bicyclists), while others were
passengers. They also may differ depending on what type of traffic unit
they were, for example occupants of a light duty vehicle or a truck,
motorcyclists, or pedestrians. The multiplicity of roles makes for
complicated modelling choices when trying to understand the severity of
injuries; for example, what is the unit of analysis, the person, the
traffic unit, or the collision? Not surprisingly, it is possible to find
examples of studies that adopt different perspectives. A common
simplifying strategy to specify a model is to consider only
\emph{drivers} and/or only \emph{single-vehicle} crashes (e.g., Kim et
al., 2013; Gong and Fan, 2017; Lee and Li, 2014; Osman et al., 2018).
This strategy reduces the dimensions of the event, and it becomes
possible, for example, to equate the traffic unit to the person for
modelling purposes.

The situation becomes more complex when dealing with events that involve
two traffic units (e.g., Tarrao et al., 2014; Wang et al., 2015) and
multi-traffic unit crashes (e.g., Wu et al., 2014; Bogue et al., 2017).
Different strategies have been developed to study these, more complex
cases. A number of studies advocate the estimation of separate models
for different participants and/or situations. In this way, Wang and
Kockelman (2005) estimated models for single-vehicle and two-vehicle
crashes, while Savolainen and Mannering (2007) estimated models for
single-vehicle and multi-vehicle crashes. More recently, Duddu et
al.~(2018) and Penmetsa et al.~(2017) presented research that estimated
separate models for at-fault and not-at-fault drivers. The strategy of
estimating separate models also relies on subsetting the dataset,
although it is possible to link the relevant models more tightly by
means of a common covariance structure, as is the case of bivariate
models (e.g., Chiou et al., 2013; Chen et al., 2019) or models with
copulas (e.g., Rana et al., 2010; Shamsunnahar et al., 2014; Wang et
al., 2015).

A related strategy to specify a crash severity model is to organize the
data in such a way that it is possible to model the influence of the
attributes of the opponent in a crash. There are numerous examples of
studies that consider at least some characteristics of the oponents in
two- or multi-vehicle crashes. For example, Wang and Kockelman (2005)
considered the type of the opposing vehicle in their model for
two-vehicle collisions. Similarly, Tarrao et al.~(2014) included in
their analysis the age, wheelbase, weight, and engine size of the
opposing vehicle while Bogue et al.~(2017) used the body type of the
opposing vehicle. Penmetsa et al.~(2017) and Duddu et al.~(2018) are two
of the most comprehensive examples of using opponent's information, with
the physical condition, sex, age, and vehicle type of the opponent. The
twin strategies of subsetting the sample and using the attributes of the
opponent are not mutually exclusive, but neither are they consistently
used together, as a scan of the literature reveals.

\begin{table}

\caption{\label{tab:table-variable-categories}\label{tab:variable-categories}Categories of variables used in the analysis of crash severity with examples}
\centering
\fontsize{7}{9}\selectfont
\begin{tabular}[t]{l>{\raggedright\arraybackslash}p{22em}}
\toprule
Category & Examples\\
\midrule
Person-related & Attributes of participants in the crash, e.g., injury status, age, gender, licensing status, professional driver status\\
Traffic unit-related & Attributes of the traffic unit, e.g., type of traffic unit (car, motorcycle, etc.), maneouver, etc.\\
Crash-related & Attributes of the crash, e.g., location, weather conditions, light conditions, number of parties, etc.\\
Road-related & Attributes of the road, e.g., surface condition, grade, geometry, etc.\\
Opponent-related & Attributes of the opponent, e.g., age of opponent, gender of opponent, opponent vehicle type, etc.\\
\bottomrule
\end{tabular}
\end{table}

\hypertarget{modelling-techniques}{%
\subsection{Modelling techniques}\label{modelling-techniques}}

With respect to model structures, Shamsunnahar and Eluru (2013)
conducted an extensive comparison of models for discrete outcomes and
found only small differences in the performance of unordered models and
ordered models; however, ordered models are usually more parsimonious
since only one latent functions needs to be estimated for all outcomes,
as opposed to one for each outcome in unordered modelling mechanisms.
Bogue et al.~(2017) also compared unordered and ordered models in the
form of the mixed multinomial logit and a modified rank ordered logit,
respectively, and found that the ordered model performed best. To keep
the empirical assessment managable we will consider only the ordinal
logit model, and will comment on potential extensions in Section
\ref{sec:further-considerations}.

The ordinal model is a latent-variable approach, whereby the severity of
the crash (observed) is linked to an underlying latent variable that is
a function of the variables of interest, as follows:

\begin{equation}
\label{eq:latent-function}
y_{itk}^*=\sum_{l=1}^L\alpha_lp_{itkl} + \sum_{m=1}^M\beta_mu_{tkm} + \sum_{q=1}^Q\kappa_qc_{kq} + \epsilon_{itk}
\end{equation}

The left-hand side of the expression above (\(y_{itk}^*\)) is a latent
(unobservable) variable that is associated with the severity of crash
\(k\) (\(k=1,\cdots,K\)) for participant \(i\) in traffic unit \(t\).
The right-hand side of the expression is split in four parts. The first
part collects \(l=1,\cdots,L\) individual attributes \(p\) for
participant \(i\) in traffic unit \(t\) and crash \(k\); these could
relate to the person (e.g., age, gender, and road user class). The
second part collects \(m=1,\cdots,M\) attributes \(u\) related to
traffic unit \(t\) in crash \(k\); these could be items such as maneuver
or vehicle type. The third part collects \(q=1,\cdots,Q\) attributes
\(c\) related to the crash \(k\), including crash-related and
road-related data, such as weather conditions, road alignment, and type
of surface. Lastly, the fourth element is a random term specific to
participant \(i\) in traffic unit \(t\) and crash \(k\). The function
consists of a total of \(Z=L+M+Q\) covariates and associated parameters.

When opponent-related variables are included, the function is augmented
as follows:

\begin{equation}
\label{eq:latent-function-with-opponent-variables}
y_{itk}^*=\sum_{l=1}^L\alpha_lp_{itkl} + \sum_{m=1}^M\beta_mu_{tkm} + \sum_{q=1}^Q\kappa_qc_{kq} + \sum_{r=1}^R\delta_ro_{jvkr} + \epsilon_{itk}
\end{equation}

The additional part collects \(r=1,\cdots,R\) attributes \(o\) related
to individual \(j\) in traffic unit \(v\) and crash \(k\) that opposed
individual \(i\) in traffic unit \(t\) and crash \(k\). These could be
individual characteristics of the opponent (such as age and gender)
and/or characteristics of the opposing vehicle (such as vehicle type or
weight). To qualify as an opponent, individual \(j\) must have been a
participant in crash \(k\) but operating traffic unit \(v\ne t\).
Sometimes the person \emph{is} the traffic unit, as is the case of a
pedestrian. And we exclude passengers of vehicles as opponents, since
they do not operate the traffic unit. In case the opponent attributes
include only characteristics of the traffic unit, the condition for the
traffic unit to be an opponent is that it participated in crash \(k\)
and was different from \(t\). After introducing this new set of terms,
the latent function now consists of a total of \(Z=L+M+Q+R\) covariates
and associated parameters.

For conciseness, in what follows we will abbreviate the function as
follows:

\begin{equation}
\label{eq:latent-function-compact}
y_{itk}^*=\sum_{z=1}^Z\theta_zx_{itkz} + \epsilon_{itk}
\end{equation}

The latent variable is not observed directly, but it is possible to
posit a probabilistic relationship with the outcome \(y_{ik}\) (the
severity of crash \(k\) for participant \(i\)). Depending on the
characteristics of the data and the assumptions made about the random
component of the latent function different models can be obtained. For
example, if crash severity is coded as a binary variable (e.g.,
non-fatal/fatal), we can relate the latent variable to the outcome as
follows:

\begin{equation}
\label{eq:latent-function-2-outcomes}
y_{itk} = 
\begin{cases}
\text{fatal} & \text{if } y_{itk}^*>0\\
\text{non-fatal} & \text{if } y_{itk}^*\leq0
\end{cases}
\end{equation}

Due to the stochastic nature of the latent function, the outcome of the
crash is not fully determined. However, we can make the following
probability statement:

\begin{equation}
\label{eq:probability-2-outcomes}
P(y_{itk} = \text{fatal}) = P(y_{itk}^* > 0)
\end{equation}

In other words, the probability that individual \(i\) in traffic unit
\(k\) and crash \(k\) was a fatality equals the probability that the
latent variable is greater than zero. This implies (see Maddala, 1986,
p. 22):

\begin{equation}
\label{eq:probability-2-outcomes-2}
\begin{array}{rl}\
P(y_{itk} = \text{fatal}) &= P(\sum_{z=1}\theta_zp_{itkz} + \epsilon_{itk} > 0)\\ 
&=P(\epsilon_{itk} > -\sum_{z=1}\theta_zp_{itkz})
\end{array}
\end{equation}

If the random terms \(\epsilon_{itk}\) are assumed to follow the
logistic distribution, the the binary logit model is obtained; if they
are assumed to follow the normal distribution, the binary probit model
is obtained. More often, though, the outcome is recorded using more
categories, for example property damage only (PDO)/injury/fatality. A
similar approach can be adopted, with a latent variable that relates to
the outcome as follows:

\begin{equation}
\label{eq:latent-function-ordered-outcomes}
y_{itk} = 
\begin{cases}
\text{fatality} & \text{if } y_{itk}^*> \mu_2\\
\text{injury} & \text{if } \mu_1< y_{itk}^*< \mu_2\\
\text{PDO} & \text{if } y_{itk}^*< \mu_1
\end{cases}
\end{equation}

\noindent where \(\mu_1\) and \(\mu_2\) are estimable thresholds. In
this case, the associated probability statements are as follows:

\begin{equation}
\label{eq:probability-ordered-outcomes}
\begin{array}{rcl}\
P(y_{itk} = \text{PDO}) &=& 1 - P(y_{itk} = \text{injury}) - P(y_{itk} = \text{fatality})\\ 
P(y_{itk} = \text{injury}) &=& P(\mu_1 - \sum_{z=1}\theta_zp_{itkz} < \epsilon_{itk} < \mu_2 - \sum_{z=1}\theta_zp_{itkz})\\
P(y_{itk} = \text{fatality}) &=& P(\epsilon_{itk} < \mu_1 - \sum_{z=1}\theta_zp_{itkz})
\end{array}
\end{equation}

If the random terms are assumed to follow the logistic distribution, the
ordered logit model is obtained; if the normal distribution, then the
ordered probit model. Estimation methods for these models are very
well-established (e.g., Maddala, 1986; Train, 2009)

There are numerous variations of the basic modelling framework above,
including hierarchical models, bivariate models, multinomial models, and
Bayesian models, among others (see Savolainen et al., 2011 for a review
of methods).

\hypertarget{model-specification-strategies}{%
\subsection{Model specification
strategies}\label{model-specification-strategies}}

In this paper we consider three general model specification strategies,
as follows:

\begin{itemize}
\tightlist
\item
  Strategy 1. Introducing opponent-related variables
\item
  Strategy 2. Single-level model and multi-level (hierarchical) model
  specifications
\item
  Strategy 3. Full sample and sample subsetting
\end{itemize}

Introduction of opponent related-variables was explained in the
preceding subsection. In this way, a base model is given by Equation
\ref{eq:latent-function}, whereas Strategy 1 (inclusion of
opponent-related variables) is Equation
\ref{eq:latent-function-with-opponent-variables}. These two equations
are also examples of single-level model. Next we describe Strategies 2
and 3.

\hypertarget{hierarchical-model-specification}{%
\subsubsection{Hierarchical model
specification}\label{hierarchical-model-specification}}

We can choose to conceptualize the event leading to the outcome as a
hierarchical process. There are a few different ways of doing this. For
example, the hierarchy could be based on individuals in traffic units.
In this case, we can rewrite the latent function as follows:

\begin{equation}
\label{eq:latent-function-with-hierarchical-traffic-unit}
y_{itk}^*=\sum_{m=1}^M\beta_mu_{tkm} + \sum_{q=1}^Q\kappa_qc_{kq} + \sum_{r=1}^R\delta_ro_{jvkr} + \epsilon_{itk}
\end{equation}

The coefficients of the traffic unit nest the individual attributes as
follows. For any given coefficient \(q\):

\begin{equation}
\label{eq:hierarchical-traffic-unit-coefficients}
\beta_{m}=\sum_{l=1}^L\beta_{ml}p_{itkl} 
\end{equation}

Therefore, the corresponding term in the latent function becomes
(assuming that \(p_{itk1} = 1\), i.e., it is a constant term):

\begin{equation}
\label{eq:hierarchical-traffic-unit-coefficients}
\begin{array}{rcl}\
\beta_{m}u_{tkm} &=& \big( \beta_{m1} + \beta_{m2}p_{itk2} + \cdots + \beta_{mL}p_{itkL}\big)u_{tkm}\\ 
&=& \beta_{m1}u_{tkm} + \beta_{m2}p_{itk2}u_{tkm} + \cdots + \beta_{mL}p_{itkL}u_{tkm}
\end{array}
\end{equation}

As an alternative, the nesting unit could be the interaction
person-opponent, in which case the opponent-level attributes are nested

\begin{equation}
\label{eq:latent-function-with-opponent-variables}
y_{itk}^*=\sum_{l=1}^L\alpha_lp_{itkl} + \sum_{m=1}^M\beta_mu_{tkm} + \sum_{q=1}^Q\kappa_qc_{kq} + \epsilon_{itk}
\end{equation}

\noindent with any person-level coefficient \(l\) that we wish to expand
defined as follows:

\begin{equation}
\label{eq:hierarchical-traffic-unit-coefficients}
\alpha_{l}=\sum_{r=1}^R\alpha_{lr}o_{jvkr}
\end{equation}

\noindent with the same conditions as before, that \(j\ne i\) is the
operator of traffic unit \(v\ne t\). The corresponding term in the
latent function is now (assuming that \(o_{jvk1}=1\), i.e., it is a
constant term):

\begin{equation}
\label{eq:hierarchical-traffic-unit-coefficients}
\begin{array}{rcl}\
\alpha_{l}p_{itkl} &=& \big(\alpha_{l1} + \alpha_{l2}o_{jvk2} + \cdots + \alpha_{lR}o_{jvkR} \big)p_{itkl}\\
&=& \alpha_{l1}p_{itkl} + \alpha_{l2}o_{jvk2}p_{itkl} + \cdots + \alpha_{lR}o_{jvkR}p_{itkl}
\end{array} 
\end{equation}

Alterted readers will identify this model specification strategy as
Casetti's expansion method (Casetti, 1972). This is a deterministic
strategy for modelling contextual effects which, when augmented with
random components, becomes the well-known multi-level modelling method
(Hedeker and Gibbons, 1994, more on this in Section
\ref{sec:further-considerations}). It is worthwhile to note that
higher-order hierarchical effects are possible; for instance, individual
attributes nested within traffic units, which in turn are nested within
collisions. We do not explore this further in the current paper.

\hypertarget{sample-subsetting}{%
\subsubsection{Sample subsetting}\label{sample-subsetting}}

The third model specification strategy that we will consider is
subsetting the sample. This is applicable in conjunction with any of the
other strategies discussed above. In essence, we define the latent
function with restrictions as follows. Consider a continuous variable,
e.g., age of person, and we wish to concentrate the analysis on older
adults (e.g., Dissanayake and Lu, 2002). The latent function is defined
as desired (see above), however, the following restriction might be
applied to the sample

\begin{equation}
\label{eq:sampling-age}
\text{Age of individual } i \text{ in traffic unit } t \text{ in crash } k = 
\begin{cases}
\ge 65 & \text{use record } itk\\
< 65 & \text{do not use record } itk
\end{cases}
\end{equation}

Suppose instead that we are interested in crashes by or against a
specific type of traffic unit (e.g., pedestrians, Amoh-Gyimah et al.,
2017):

\begin{equation}
\label{eq:sampling-pedestrian}
\text{Road user class of individual } i \text{ in traffic unit } t \text{ in crash } k = 
\begin{cases}
\text{Pedestrian} & \text{use record } itk\\
\text{Not pedestrian} & \text{do not use record } itk
\end{cases}
\end{equation}

\noindent or:

\begin{equation}
\label{eq:sampling-pedestrian-opponent}
\text{Road user class of individual } j \text{ in traffic unit } v \text{ in crash } k = 
\begin{cases}
\text{Pedestrian} & \text{use record } jvk\\
\text{Not pedestrian} & \text{do not use record } jvk
\end{cases}
\end{equation}

More generally, for any variable \(x\) of interest:

\begin{equation}
\label{eq:sampling-general}
x_{itk} = 
\begin{cases}
\text{Condition: TRUE} & \text{use record } itk\\
\text{Condition: FALSE} & \text{do not use record } itk
\end{cases}
\end{equation}

Several conditions can be imposed to subset the sample in any way that
the analyst deems appropriate or suitable.

\hypertarget{sec:application}{%
\section{Setting for empirical assessment}\label{sec:application}}

In this section we present the setting for the empirical assessment of
the modelling strategies discussed in Section
\ref{sec:review-of-methods}, namely matters related to data and model
estimation.

\begin{quote}
\textbf{Note:} this paper presents reproducible research. The source
file is an R Markdown document. All code and data necessary to reproduce
the analysis are available from the following anonymous Drive folder:
\end{quote}

\begin{quote}
https://drive.google.com/open?id=12aJtVBaQ4Zj0xa7mtfqxh0E48hKCb\_XV
\end{quote}

\begin{quote}
The source files, code, and data will be publicly available in a GitHub
repository upon acceptance of the paper for publication
\end{quote}

\hypertarget{data-for-empirical-assessment}{%
\subsection{Data for empirical
assessment}\label{data-for-empirical-assessment}}

To assess the performance of the various modelling strategies we use
data from Canada's National Collision Database (NCDB). This is database
contains all motor vehicle collisions on public roads in Canada as
reported by a police service. Data are collected by provinces and
territories, and shared with the federal government, where data are
combined, tracked, and analyzed for reporting of deaths, injuries, and
collisions in Canada at the national level. The NCDB is provided by
Transport Canada, the agency of the federal government of Canada in
charge of transportation policies and programs, under the Open
Government License - Canada version 2.0
{[}https://open.canada.ca/en/open-government-licence-canada{]}.

The NCDB is available from 1999. For the purpose of this paper, we use
the data corresponding to 2017, which is the most recent year available
as of this writing. Furthermore, for assessment we also use the data
corresponding to 2016. Similar to databases in other jurisdictions (see
Montella et al., 2013), the NCDB contains information pertaining to the
collision, the traffic unit(s), and the person(s) involved in a crash,
as shown in Tables \ref{tab:ncdb-descriptives-collision},
\ref{tab:ncdb-descriptives-vehicle}, and
\ref{tab:ncdb-descriptives-person}. Notice that, compared to Table
\ref{tab:variable-categories}, crash-related variables and road-related
variables are collected in a single variable class, namely
collision-related, since they are unique for each crash.

Data are organized by person; in other words, there is one record per
participant in a collision, be they drivers, passengers, pedestrians,
etc. The only variable directly available with respect to opponents in a
collision is the number of vehicles involved (see models in Bogue et
al., 2017). Therefore, the data needs to be processed to obtain
attributes of opponents for each participant in a collision. The
protocol to do this is described next.

\begingroup\fontsize{7}{9}\selectfont

\begin{longtable}[t]{ll>{\raggedright\arraybackslash}p{32em}}
\caption{\label{tab:ncdb-descriptives-collision}\label{tab:ncdb-descriptives-collision}Contents of National Collision Database: Collision-level variables}\\
\toprule
Variable & Description & Notes\\
\midrule
\endfirsthead
\caption[]{\label{tab:ncdb-descriptives-collision}Contents of National Collision Database: Collision-level variables \textit{(continued)}}\\
\toprule
Variable & Description & Notes\\
\midrule
\endhead
\
\endfoot
\bottomrule
\multicolumn{3}{l}{\textit{Note: }}\\
\multicolumn{3}{l}{Source NCDB available from https://open.canada.ca/data/en/dataset/1eb9eba7-71d1-4b30-9fb1-30cbdab7e63a}\\
\multicolumn{3}{l}{Preprocessed data for analysis available from https://drive.google.com/open?id=12aJtVBaQ4Zj0xa7mtfqxh0E48hKCb\_XV}\\
\endlastfoot
\rowcolor{gray!6}  C\_CASE & Unique collision identifier & Unique identifier for collisions\\
C\_YEAR & Year & Last two digits of year.\\
\rowcolor{gray!6}  C\_MNTH & Month & 14 levels: January - December; unknown; not reported by jurisdiction.\\
C\_WDAY & Day of week & 9 levels: Monday - Sunday; unknown; not reported by jurisdiction.\\
\rowcolor{gray!6}  C\_HOUR & Collision hour & 25 levels: hourly intervals; unknown; not reported by jurisdiction.\\
\addlinespace
C\_SEV & Collision severity & 4 levels: collision producing at least one fatality; collision producing non-fatal injury; unknown; not reported by jurisdiction.\\
\rowcolor{gray!6}  C\_VEHS & Number of vehicles involved in collision & Number of vehicles: 1-98 vehicles involved; 99 or more vehicles involved; unknown; not reported by jurisdiction.\\
C\_CONF & Collision configuration & 21 levels: SINGLE VEHICLE: Hit a moving object (e.g. a person or an animal); Hit a stationary object (e.g. a tree); Ran off left shoulder; Ran off right shoulder; Rollover on roadway; Any other single vehicle collision configuration; TWO-VEHICLES SAME DIRECTION OF TRAVEL: Rear-end collision; Side swipe; One vehicle passing to the left of the other, or left turn conflict; One vehicle passing to the right of the other, or right turn conflict; Any other two vehicle - same direction of travel configuration; TWO-VEHICLES DIFFERENT DIRECTION OF TRAVEL: Head-on collision; Approaching side-swipe; Left turn across opposing traffic; Right turn, including turning conflicts; Right angle collision; Any other two-vehicle - different direction of travel configuration; TWO-VEHICLES, HIT A PARKED VEHICLE: Hit a parked motor vehicle; Choice is other than the preceding values; unknown;not reported by jurisdiction.\\
\rowcolor{gray!6}  C\_RCFG & Roadway configuration & 15 levels: Non-intersection; At an intersection of at least two public roadways; Intersection with parking lot entrance/exit, private driveway or laneway; Railroad level crossing; Bridge, overpass, viaduct; Tunnel or underpass; Passing or climbing lane; Ramp; Traffic circle; Express lane of a freeway system; Collector lane of a freeway system; Transfer lane of a freeway system; Choice is other than the preceding values; unknown;not reported by jurisdiction.\\
C\_WTHR & Weather condition & 10 levels: Clear and sunny; Overcast, cloudy but no precipitation; Raining; Snowing, not including drifting snow; Freezing rain, sleet, hail; Visibility limitation; Strong wind; Choice is other than the preceding values; unknown;not reported by jurisdiction.\\
\addlinespace
\rowcolor{gray!6}  C\_RSUR & Road surface & 12 levels: Dry, normal; Wet; Snow (fresh, loose snow); Slush, wet snow; Icy, packed snow; Debris on road (e.g., sand/gravel/dirt); Muddy; Oil; Flooded; Choice is other than the preceding values; unknown;not reported by jurisdiction.\\
C\_RALN & Road alignment & 9 levels: Straight and level; Straight with gradient; Curved and level; Curved with gradient; Top of hill or gradient; Bottom of hill or gradient; Choice is other than the preceding values; unknown;not reported by jurisdiction.\\
\rowcolor{gray!6}  C\_TRAF & Traffic control & 21 levels: Traffic signals fully operational; Traffic signals in flashing mode; Stop sign; Yield sign; Warning sign; Pedestrian crosswalk; Police officer; School guard, flagman; School crossing; Reduced speed zone; No passing zone sign; Markings on the road; School bus stopped with school bus signal lights flashing; School bus stopped with school bus signal lights not flashing; Railway crossing with signals, or signals and gates; Railway crossing with signs only; Control device not specified; No control present; Choice is other than the preceding values; unknown; not reported by jurisdiction.\\*
\end{longtable}
\endgroup{}

\begingroup\fontsize{7}{9}\selectfont

\begin{longtable}[t]{ll>{\raggedright\arraybackslash}p{32em}}
\caption{\label{tab:ncdb-descriptives-vehicle}\label{tab:ncdb-descriptives-vehicle}Contents of National Collision Database: Traffic unit-level variables}\\
\toprule
Variable & Description & Notes\\
\midrule
\endfirsthead
\caption[]{\label{tab:ncdb-descriptives-vehicle}Contents of National Collision Database: Traffic unit-level variables \textit{(continued)}}\\
\toprule
Variable & Description & Notes\\
\midrule
\endhead
\
\endfoot
\bottomrule
\multicolumn{3}{l}{\textit{Note: }}\\
\multicolumn{3}{l}{Source NCDB available from https://open.canada.ca/data/en/dataset/1eb9eba7-71d1-4b30-9fb1-30cbdab7e63a}\\
\multicolumn{3}{l}{Preprocessed data for analysis available from https://drive.google.com/open?id=12aJtVBaQ4Zj0xa7mtfqxh0E48hKCb\_XV}\\
\endlastfoot
\rowcolor{gray!6}  V\_ID & Vehicle sequence number & Number of vehicles: 1-98; Pedestrian sequence number: 99; unknown.\\
V\_TYPE & Vehicle type & 21 levels: Light Duty Vehicle (Passenger car, Passenger van, Light utility vehicles and light duty pick up trucks); Panel/cargo van (<= 4536 KG GVWR   Panel or window type of van designed primarily for carrying goods); Other trucks and vans (<= 4536 KG GVWR); Unit trucks (> 4536 KG GVWR); Road tractor; School bus; Smaller school bus (< 25 passengers); Urban and Intercity Bus; Motorcycle and moped; Off road vehicles; Bicycle; Purpose-built motorhome; Farm equipment; Construction equipment; Fire engine; Snowmobile; Street car; Data element is not applicable  (e.g. dummy vehicle record created for pedestrian); Choice is other than the preceding values; unknown; not reported by jurisdiction.\\
\rowcolor{gray!6}  V\_YEAR & Vehicle model year & Model year; dummy for pedestrians; unknown; not reported by jurisdiction.\\*
\end{longtable}
\endgroup{}

\begingroup\fontsize{7}{9}\selectfont

\begin{longtable}[t]{ll>{\raggedright\arraybackslash}p{32em}}
\caption{\label{tab:ncdb-descriptives-person}\label{tab:ncdb-descriptives-person}Contents of National Collision Database: Personal-level variables}\\
\toprule
Variable & Description & Notes\\
\midrule
\endfirsthead
\caption[]{\label{tab:ncdb-descriptives-person}Contents of National Collision Database: Personal-level variables \textit{(continued)}}\\
\toprule
Variable & Description & Notes\\
\midrule
\endhead
\
\endfoot
\bottomrule
\multicolumn{3}{l}{\textit{Note: }}\\
\multicolumn{3}{l}{Source NCDB available from https://open.canada.ca/data/en/dataset/1eb9eba7-71d1-4b30-9fb1-30cbdab7e63a}\\
\multicolumn{3}{l}{Preprocessed data for analysis available from https://drive.google.com/open?id=12aJtVBaQ4Zj0xa7mtfqxh0E48hKCb\_XV}\\
\endlastfoot
\rowcolor{gray!6}  P\_ID & Person sequence number & Sequence number: 1-99; Not applicable (dummy for parked vehicles); not reported by jurisdiction.\\
P\_SEX & Person sex & 5 levels: Male; Female; Not applicable (dummy for parked vehicles); unknown (runaway vehicle); not reported by jurisdiction.\\
\rowcolor{gray!6}  P\_AGE & Person age & Age: less than 1 year; 1-98 years old; 99 years or older; Not applicable (dummy for parked vehicles); unknown (runaway vehicle); not reported by jurisdiction.\\
P\_PSN & Person position & Person position: Driver; Passenger front row, center; Passenger front row, right outboard (including motorcycle passenger in sidecar); Passenger second row, left outboard, including motorcycle passenger; Passenger second row, center; Passenger second row, right outboard; Passenger third row, left outboard;...; Position unknown, but the person was definitely an occupant; Sitting on someoneâ€™s lap; Outside passenger compartment; Pedestrian; Not applicable (dummy for parked vehicles); Choice is other than the preceding values; unknown (runaway vehicle); not reported by jurisdiction.\\
\rowcolor{gray!6}  P\_ISEV & Medical treatment required & 6 levels: No Injury; Injury; Fatality; Not applicable (dummy for parked vehicles); Choice is other than the preceding values; unknown (runaway vehicle); not reported by jurisdiction.\\
\addlinespace
P\_SAFE & Safety device used & 11 levels: No safety device used; Safety device used; Helmet worn; Reflective clothing worn; Both helmet and reflective clothing used; Other safety device used; No safety device equipped   (e.g. buses); Not applicable (dummy for parked vehicles); Choice is other than the preceding values; unknown (runaway vehicle); not reported by jurisdiction.\\
\rowcolor{gray!6}  P\_USER & Road user class & 6 levels: Motor Vehicle Driver; Motor Vehicle Passenger; Pedestrian; Bicyclist; Motorcyclist; Not stated/Other/Unknown.\\*
\end{longtable}
\endgroup{}

\hypertarget{data-preprocessing-initial-filter}{%
\subsubsection{Data preprocessing: initial
filter}\label{data-preprocessing-initial-filter}}

The database is scanned to remove all records that are not a person
(including parked cars and other objects) or that are missing
information (e.g., runaway vehicles). Next, records missing at least one
of the next variables are removed: P\_USER (the road user class), P\_SEX
(sex), P\_AGE (age), and P\_ISEV (individual-level severity of crash).
This initial filter ensures that all records are complete from the
perspective of key information.

\hypertarget{data-preprocessing-filter-two-vehicle-collisions}{%
\subsubsection{Data preprocessing: filter two-vehicle
collisions}\label{data-preprocessing-filter-two-vehicle-collisions}}

After the initial filter, the database is summarized to find the number
of individual-level records that correspond to each collision (C\_CASE).
At this point, there are 32,298 collisions, involving only one (known)
participant, there are 46,483 collisions involving two participants,
19,433 involving 3 participants, 8,250 involving four participants,
3,783 involving 5 participants, 1,789 involving 6 participants, and
1,491 collisions involving seven or more participants. These
participants were possibly occupants in different vehicles or were
otherwise their own traffic units, as follows: the sample includes
174,741 drivers, 61,403 passengers, 10,798 pedestrians, 5,286
bicyclists, and 6,564 motorcyclists.

The next step is to remove all collisions involving only one
participant. This still leaves numerous cases where multiple
participants could have been in a single vehicle, for instance in a
collision against a stationary object. Therefore, we proceed to use the
vehicle sequence number can to find the number of vehicles involved in
each collision. This reveals that there are 20,732 collisions that
involve only one vehicle but possibly multiple participants (i.e.,
driver and one or more passengers). In addition, there are 165,520
collisions involving two vehicles (and possibly multiple participants).
Finally, there are 40,242 collisions with three or more vehicles.

Once we have identified the number of vehicles in each collision, we
proceed to select all cases that involve only two vehicles. The most
common cases in two-vehicle collisions are those that include drivers
(40,297 collisions; reflective of the prevalence of single-occupant
vehicles), followed by cases with passengers (14,120 collisions),
pedestrians (5,204 collisions), byciclists (2,238 collisions), and
motorcyclists (1,016 collisions). The distribution of individuals per
traffic unit is as follows: 80,382 individuals are coded as being in
V\_ID = 1, 76,523 individuals are coded as being in V\_ID = 2, and 7,932
individuals are coded as pedestrians. In addition, 683 individuals are
coded as being in vehicles 3 through 9, despite our earlier filter to
retain only collisions with two vehicles. We therefore proceed to select
only individuals assigned to vehicles 1 or 2, as well as pedestrians. As
a result of this filter a number of cases with only one known
participant need to be removed.

\hypertarget{data-preprocessing-extract-opponent-information-and-join-to-individual-records}{%
\subsubsection{Data preprocessing: extract opponent information and join
to individual
records}\label{data-preprocessing-extract-opponent-information-and-join-to-individual-records}}

Up to this point, the goal of data preprocessing has been to obtain a
complete, workable sample of individual records of participants in
two-vehicle collisions. There are two possible cases for the collisions,
depending on the traffic units involved: 1) vehicle vs vehicle
collisions (``vehicle'' includes all motorized vehicles, as well as
motorcycles/mopeds and bicycles); and 2) vehicle vs pedestrian
collisions. To identify opponents in a collision, it is convenient to
classify collisions by pedestrian involvement. Accordingly, we find that
the database includes 16,636 collisions are vehicle vs pedestrian
(possibly multiple pedestrians), and 147,594 collisions involving two
vehicles. After splitting the database in this way, we can now extract
relevant information about participants in the collision. This involves
renaming the person-level variables depending so that we can distinguish
each individual by their role as an individual or an opponent in a given
collision. Notice that when working with individuals in vehicles, only
the driver is considered an opponent in a collisions (i.e., passengers
are never considered opponents).

Once the personal attributes of individuals that can be considered
opponents in a given collision have ben extracted, their information can
be joined to the individual records by means of the collision unique
identifier. As a result of this process, a new set of variables are now
available for analysis: the age, sex, use of safety device, and road
user class of the opponent, as well as the type of the opponent vehicle.
A summary of opponent interactions and outcomes can be found in Table
\ref{tab:summary-opponent-information}. The information there shows that
the most commont type of opponent for drivers is other drivers, followed
by pedestrians. The only opponent of pedestrians, on the other hand, are
drivers. Bicyclists and motorcyclists, on the other hand, are mostly
opposed by drivers, but occasionally by other road users as well. In
terms of outcomes, we observe that virtually all fatalities occur when
the opponent is a driver, and only very rarely when the opponent is a
motorcyclist. Injuries are also more common when the opponent is a
driver, whereas the likelihood of no injuries is higher when the
opponent is a pedestrian or a bicyclist.

\begin{table}

\caption{\label{tab:summary-opponent-information}\label{tab:summary-opponent-information}Summary of opponent interactions and outcomes by road user class}
\centering
\resizebox{\linewidth}{!}{
\fontsize{7}{9}\selectfont
\begin{tabular}[t]{lrrrrrrrlll}
\toprule
\multicolumn{1}{c}{} & \multicolumn{4}{c}{Road User Class of Opponent} & \multicolumn{3}{c}{Outcome} & \multicolumn{3}{c}{Proportion by Road User Class} \\
\cmidrule(l{3pt}r{3pt}){2-5} \cmidrule(l{3pt}r{3pt}){6-8} \cmidrule(l{3pt}r{3pt}){9-11}
Road User Class & Driver & Pedestrian & Bicyclist & Motorcyclist & No Injury & Injury & Fatality & No Injury & Injury & Fatality\\
\midrule
\rowcolor{gray!6}  \addlinespace[0.3em]
\multicolumn{11}{l}{\textbf{All opponents}}\\
\hspace{1em}Driver & 97582 & 7880 & 3799 & 2498 & 59180 & 52143 & 436 & 0.52953 & 0.46657 & 0.003901\\
\hspace{1em}Passenger & 35359 & 1282 & 667 & 818 & 19308 & 18667 & 151 & 0.50643 & 0.48961 & 0.003961\\
\rowcolor{gray!6}  \hspace{1em}Pedestrian & 7880 & 0 & 0 & 0 & 145 & 7507 & 228 & 0.01840 & 0.95266 & \vphantom{1} 0.028934\\
\hspace{1em}Bicyclist & 3799 & 1 & 0 & 40 & 49 & 3760 & 31 & 0.01276 & 0.97917 & 0.008073\\
\rowcolor{gray!6}  \hspace{1em}Motorcyclist & 2498 & 30 & 40 & 338 & 204 & 2598 & 104 & 0.07020 & 0.89401 & 0.035788\\
\addlinespace[0.3em]
\multicolumn{11}{l}{\textbf{Opponent: Driver}}\\
\hspace{1em}Driver & 97582 & 0 & 0 & 0 & 45493 & 51657 & 432 & 0.46620 & 0.52937 & 0.004427\\
\rowcolor{gray!6}  \hspace{1em}Passenger & 35359 & 0 & 0 & 0 & 16672 & 18536 & 151 & 0.47151 & 0.52422 & 0.004270\\
Pedestrian & 7880 & 0 & 0 & 0 & 145 & 7507 & 228 & 0.01840 & 0.95266 & \vphantom{1} 0.028934\\
\rowcolor{gray!6}  \hspace{1em}Bicyclist & 3799 & 0 & 0 & 0 & 43 & 3725 & 31 & 0.01132 & 0.98052 & 0.008160\\
\hspace{1em}Motorcyclist & 2498 & 0 & 0 & 0 & 98 & 2299 & 101 & 0.03923 & 0.92034 & 0.040432\\
\rowcolor{gray!6}  \addlinespace[0.3em]
\multicolumn{11}{l}{\textbf{Opponent: Pedestrian}}\\
\hspace{1em}Driver & 0 & 7880 & 0 & 0 & 7693 & 187 & 0 & 0.97627 & 0.02373 & 0.000000\\
\hspace{1em}Passenger & 0 & 1282 & 0 & 0 & 1246 & 36 & 0 & 0.97192 & 0.02808 & 0.000000\\
\rowcolor{gray!6}  \hspace{1em}Pedestrian & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - & - & \vphantom{2} -\\
\hspace{1em}Bicyclist & 0 & 1 & 0 & 0 & 0 & 1 & 0 & 0.00000 & 1.00000 & 0.000000\\
\rowcolor{gray!6}  \hspace{1em}Motorcyclist & 0 & 30 & 0 & 0 & 11 & 19 & 0 & 0.36667 & 0.63333 & 0.000000\\
\addlinespace[0.3em]
\multicolumn{11}{l}{\textbf{Opponent: Bicyclist}}\\
\hspace{1em}Driver & 0 & 0 & 3799 & 0 & 3706 & 93 & 0 & 0.97552 & 0.02448 & 0.000000\\
\rowcolor{gray!6}  \hspace{1em}Passenger & 0 & 0 & 667 & 0 & 649 & 18 & 0 & 0.97301 & 0.02699 & 0.000000\\
\hspace{1em}Pedestrian & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - & - & \vphantom{1} -\\
\rowcolor{gray!6}  \hspace{1em}Bicyclist & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - & - & -\\
\hspace{1em}Motorcyclist & 0 & 0 & 40 & 0 & 16 & 24 & 0 & 0.40000 & 0.60000 & 0.000000\\
\rowcolor{gray!6}  \addlinespace[0.3em]
\multicolumn{11}{l}{\textbf{Opponent: Motorcyclist}}\\
\hspace{1em}Driver & 0 & 0 & 0 & 2498 & 2288 & 206 & 4 & 0.91593 & 0.08247 & 0.001601\\
\hspace{1em}Passenger & 0 & 0 & 0 & 818 & 741 & 77 & 0 & 0.90587 & 0.09413 & 0.000000\\
\rowcolor{gray!6}  Pedestrian & 0 & 0 & 0 & 0 & 0 & 0 & 0 & - & - & \vphantom{2} -\\
\hspace{1em}Bicyclist & 0 & 0 & 0 & 40 & 6 & 34 & 0 & 0.15000 & 0.85000 & 0.000000\\
\rowcolor{gray!6}  \hspace{1em}Motorcyclist & 0 & 0 & 0 & 338 & 79 & 256 & 3 & 0.23373 & 0.75740 & 0.008876\\
\bottomrule
\end{tabular}}
\end{table}

\hypertarget{model-estimation}{%
\subsection{Model estimation}\label{model-estimation}}

Before model estimation, the variables are prepared as follows. First,
age is scaled from years to decades. Secondly, new variables are defined
to describe the vehicle type. Three classes of vehicle types are
considered: 1) light duty vehicles (which in Canada include passenger
cars, passenger vans, light utility vehicles, and light duty pick up
trucks); 2) light trucks (all other vehicles \(\le\) 4536 kg in gross
vehicle weight rating); and heavy vehicles (all other vehicles \(\ge\)
4536 in gross vehicle weight rating). Furthermore, this classification
of vehicle types is combined with the road user class to distiguish
between drivers and passengers of light duty vehicles, light trucks, and
heavy vehicles, in addition to pedestrians, bicyclists, and
motorcyclists. This is done for both the individual and the opponent.
Variable interactions are calculated to produce hierarchical variables.
For example, for a hierarchical definition of traffic unit-level
variables, age (and the square of aged) are interacted with gender, road
user class, and vehicle type. For hierarchical opponent variables, age
(and the square of age) are interacted with age of opponent (and squared
aged of opponent). The variables thus obtained are shown in Table
\ref{tab:model-specification-summary}. As seen in the table, Models 1
and 2 are single-level models, and the difference between them is that
Model 2 includes opponent variables. Models 3 and 4, in contrast, are
hierarchical models. Model 3 considers the hierarchy on the basis of the
traffic unit, while Model 4 considers the hierarchy on the basis of the
collision.

Models 1 through 4 are estimated using the full sample. As discussed
above, a related modelling strategy is to subset the sample (e.g., Islam
et al., 2014; Lee and Li, 2014; Tarrao et al., 2014; Wu et al., 2014).
In this case we subset by a combination of traffic unit type of the
individual (i.e., light duty vehicle, light truck, heavy vehicle,
pedestrian, bicyclist, and motorcyclist) and vehicle type of the oponent
(i.e., light duty vehicle, light truck, heavy vehicle). This leads to an
ensemble of eighteen models to be estimated using subsets of data (see
Table \ref{tab:model-specification-summary}). By subsetting the sample,
opponent effects are incorporated implicitly. Models 1 and 2 are
re-estimated using this strategy, dropping variables as necessary where
they are irrelevant (for instance, after filtering for pedestrians, no
other traffic unit types are present in the subset of data).

\begin{table}

\caption{\label{tab:model-specification-summary}\label{tab:model-specification-summary}Summary of variables and model specification}
\centering
\resizebox{\linewidth}{!}{
\fontsize{7}{9}\selectfont
\begin{tabular}[t]{llllll}
\toprule
Variable & Notes & Model 1 & Model 2 & Model 3 & Model 4\\
\midrule
\rowcolor{gray!6}  \addlinespace[0.3em]
\multicolumn{6}{l}{\textbf{Individual-level variables}}\\
\hspace{1em}Age & In decades & $\checkmark$ & $\checkmark$ & $\checkmark$ & $\checkmark$\\
\hspace{1em}Age Squared &  & $\checkmark$ & $\checkmark$ & $\checkmark$ & $\checkmark$\\
\rowcolor{gray!6}  \hspace{1em}Sex & Reference: Female & $\checkmark$ & $\checkmark$ & $\checkmark$ & $\checkmark$\\
\hspace{1em}Use of Safety Devices & 7 levels; Reference: No Safety Device & $\checkmark$ & $\checkmark$ & $\checkmark$ & $\checkmark$\\
\rowcolor{gray!6}  \addlinespace[0.3em]
\multicolumn{6}{l}{\textbf{Traffic unit-level variables}}\\
\hspace{1em}Passenger & Reference: Driver & $\checkmark$ & $\checkmark$ &  & $\checkmark$\\
\hspace{1em}Pedestrian & Reference: Driver & $\checkmark$ & $\checkmark$ &  & $\checkmark$\\
\rowcolor{gray!6}  \hspace{1em}Bicyclist & Reference: Driver & $\checkmark$ & $\checkmark$ &  & $\checkmark$\\
\hspace{1em}Motorcyclist & Reference: Driver & $\checkmark$ & $\checkmark$ &  & $\checkmark$\\
\rowcolor{gray!6}  \hspace{1em}Light Truck & Reference: Light Duty Vehicle & $\checkmark$ & $\checkmark$ &  & $\checkmark$\\
\hspace{1em}Heavy Vehicle & Reference: Light Duty Vehicle & $\checkmark$ & $\checkmark$ &  & $\checkmark$\\
\rowcolor{gray!6}  \addlinespace[0.3em]
\multicolumn{6}{l}{\textbf{Opponent variables}}\\
\hspace{1em}Age of Opponent & In decades &  & $\checkmark$ & $\checkmark$ & \\
\hspace{1em}Age of Opponent Squared &  &  & $\checkmark$ & $\checkmark$ & \\
\rowcolor{gray!6}  \hspace{1em}Sex of Opponent & Reference: Female &  & $\checkmark$ & $\checkmark$ & \\
\hspace{1em}Opponent: Light Duty Vehicle & Reference: Pedestrian/Bicyclist/Motorcyclist &  & $\checkmark$ & $\checkmark$ & $\checkmark$\\
\rowcolor{gray!6}  \hspace{1em}Opponent: Light Truck & Reference: Pedestrian/Bicyclist/Motorcyclist &  & $\checkmark$ & $\checkmark$ & $\checkmark$\\
\hspace{1em}Opponent: Heavy Vehicle & Reference: Pedestrian/Bicyclist/Motorcyclist &  & $\checkmark$ & $\checkmark$ & $\checkmark$\\
\rowcolor{gray!6}  \addlinespace[0.3em]
\multicolumn{6}{l}{\textbf{Hierarchical traffic unit variables}}\\
\hspace{1em}Light Truck Driver:Age &  &  &  & $\checkmark$ & \\
\hspace{1em}Light Truck Driver:Age Squared &  &  &  & $\checkmark$ & \\
\rowcolor{gray!6}  \hspace{1em}Heavy Vehicle Driver:Age &  &  &  & $\checkmark$ & \\
\hspace{1em}Heavy Vehicle Driver:Age Squared &  &  &  & $\checkmark$ & \\
\rowcolor{gray!6}  \hspace{1em}Light Truck Passenger:Age &  &  &  & $\checkmark$ & \\
\hspace{1em}Light Truck Passenger:Age Squared: &  &  &  & $\checkmark$ & \\
\rowcolor{gray!6}  \hspace{1em}Heavy Vehicle Passenger:Age &  &  &  & $\checkmark$ & \\
\hspace{1em}Heavy Vehicle Passenger:Age Squared &  &  &  & $\checkmark$ & \\
\rowcolor{gray!6}  \hspace{1em}Pedestrian:Age &  &  &  & $\checkmark$ & \\
\hspace{1em}Pedestrian:Age Squared &  &  &  & $\checkmark$ & \\
\rowcolor{gray!6}  \hspace{1em}Bicyclist:Age &  &  &  & $\checkmark$ & \\
\hspace{1em}Bicyclist:Age Squared &  &  &  & $\checkmark$ & \\
\rowcolor{gray!6}  \hspace{1em}Motorcyclist:Age &  &  &  & $\checkmark$ & \\
\hspace{1em}Motorcyclist:Age Squared &  &  &  & $\checkmark$ & \\
\rowcolor{gray!6}  \addlinespace[0.3em]
\multicolumn{6}{l}{\textbf{Hierarchical opponent variables}}\\
\hspace{1em}Age:Age of Opponent &  &  &  &  & $\checkmark$\\
\hspace{1em}Age:Age of Female Opponent &  &  &  &  & $\checkmark$\\
\rowcolor{gray!6}  \hspace{1em}Age:Age of Male Opponent Squared &  &  &  &  & $\checkmark$\\
\hspace{1em}Age:Age of Female Opponent Squared &  &  &  &  & $\checkmark$\\
\rowcolor{gray!6}  \hspace{1em}Age Squared:Age of Male Opponent &  &  &  &  & $\checkmark$\\
\hspace{1em}Age Squared:Age of Female Opponent &  &  &  &  & $\checkmark$\\
\rowcolor{gray!6}  \addlinespace[0.3em]
\multicolumn{6}{l}{\textbf{Collision-level variables}}\\
\hspace{1em}Crash Configuration & 19 levels; Reference: Hit a moving object & $\checkmark$ & $\checkmark$ & $\checkmark$ & $\checkmark$\\
\hspace{1em}Road Configuration & 12 levels; Reference: Non-intersection & $\checkmark$ & $\checkmark$ & $\checkmark$ & $\checkmark$\\
\rowcolor{gray!6}  \hspace{1em}Weather & 9 levels; Reference: Clear and sunny & $\checkmark$ & $\checkmark$ & $\checkmark$ & $\checkmark$\\
\hspace{1em}Surface & 11 levels; Reference: Dry & $\checkmark$ & $\checkmark$ & $\checkmark$ & $\checkmark$\\
\rowcolor{gray!6}  \hspace{1em}Road Alignment & 8 levels; Reference: Straight and level & $\checkmark$ & $\checkmark$ & $\checkmark$ & $\checkmark$\\
\hspace{1em}Traffic Controls & 19 levels; Reference: Operational traffic signals & $\checkmark$ & $\checkmark$ & $\checkmark$ & $\checkmark$\\
\rowcolor{gray!6}  \hspace{1em}Month & 12 levels; Reference: January & $\checkmark$ & $\checkmark$ & $\checkmark$ & $\checkmark$\\
\bottomrule
\end{tabular}}
\end{table}

Tables \ref{tab:model-full-sample-summary} and
\ref{tab:model-subsample-summary} collect some key summary statistics of
the estimated models. Of interest is the goodness of fit of the models,
which in the case is measured with Akaike's Information Criterion (AIC).
This criterion is calculated using the estimated likelihood of the
model, penalized by the number of coefficients in the model, so that,
other things being equal, it gives preference to more parsimonious
models. The objective is to minimize the AIC, and therefore smaller
values of this criterion represent better model fits. Turning our
attention to the models estimated using the full sample (Table
\ref{tab:model-full-sample-summary}), it is possible to see that,
compared to the base (single level) model without opponent variables
(Model 1), there are large and significant improvements in fit to be
gained by introducing opponent effects. However, the gains are not as
large when hierarchical specifications are used, even when the number of
additional coefficients that need to be estimated is not substantially
larger (recall that the penalty per parameter in AIC is 2). The best
model according to this measure of goodness of fit is Model 2
(single-level with opponent effects), followed by Model 4 (hierarchical
opponent variables), Model 3 (hierarchical traffic unit variables with
opponent effects), and finally Model 1 (single level without opponent
effects).

It is important to note that the likelihood function of the model, and
therefore the value of the AIC, both depend on the size of the sample,
which is why AIC is not comparable across models estimated with
different sample sizes. For this reason, the full sample models cannot
be compared directly to the models estimated with subsets of data. The
models in the ensembles, however, can be compared to each other (Table
\ref{tab:model-subsample-summary}). As seen in the table, introducing
opponent variables leads to a better fit in the case of most, but not
all models. The simplest model (single level without opponent effects)
is clearly the best fitting candidate in the case of bicycle vs light
truck collisions, bicycle vs heavy vehicle collisions, motorcyclist vs
light duty vehicle collisions, and motorcyclist vs heavy vehicle
collisions. Model 1 is a statistical toss for best performance with
other model(s) in the case of pedestrian vs heavy vehicle collisions.
The relative likelihood of Model 1 compared to Models 2 and 3 in this
case is 0.56, which means that either of these two competing models are
0.56 times as probable as Model 1 to minimize the information loss.

Model 2 is the best fit in the case of light truck vs heavy vehicle
collisions. This model is also tied for best fit with Model 2 in the
case of pedestrian vs light duty vehicle and pedestrian vs light truck
collisions, and is a statistical toss with Model 4 in the case of heavy
vehicle vs heavy vehicle collisions (relative likelihood is 0.592).
Model 3 is the best fit in the case of light duty vehicle vs light duty
vehicle collisions and heavy vehicle vs light duty vehicle. Model 4 is
the best fit in the case of light duty vehicle vs light truck
collisions, light duty vehicle vs heavy vehicle collisions, light truck
vs light duty vehicle collisions, heavy vehicle vs light truck
collisions, and motorcycle vs light truck collisions. This model is a
statistical toss with Model 2 in the case of light truck vs light truck
collisions, with a relative likelihood of 0.791.

These results give some preliminary ideas about the relative performance
of the different modelling strategies. In the next section we delve more
deeply into this question.

\begin{table}

\caption{\label{tab:model-full-sample-summary}\label{tab:model-full-sample-summary}Summary of model estimation results: Full sample models}
\centering
\fontsize{7}{9}\selectfont
\begin{tabular}[t]{lccc}
\toprule
Model & \makecell[l]{Number of\\observations} & \makecell[l]{Number of\\coefficients} & AIC\\
\midrule
\rowcolor{gray!6}  Model 1 & 164,511 & 102 & 195,215\\
Model 2 & 164,511 & 108 & 178,943\\
\rowcolor{gray!6}  Model 3 & 164,511 & 118 & 181,333\\
Model 4 & 164,511 & 111 & 179,018\\
\bottomrule
\end{tabular}
\end{table}

\begin{landscape}\begin{table}

\caption{\label{tab:model-subsample-summary}\label{tab:model-summary}Summary of model estimation results: Subsample Models}
\centering
\resizebox{\linewidth}{!}{
\fontsize{7}{9}\selectfont
\begin{tabular}[t]{lccccccccc}
\toprule
\multicolumn{1}{c}{ } & \multicolumn{1}{c}{ } & \multicolumn{2}{c}{Model 1} & \multicolumn{2}{c}{Model 2} & \multicolumn{2}{c}{Model 3} & \multicolumn{2}{c}{Model 4} \\
\cmidrule(l{3pt}r{3pt}){3-4} \cmidrule(l{3pt}r{3pt}){5-6} \cmidrule(l{3pt}r{3pt}){7-8} \cmidrule(l{3pt}r{3pt}){9-10}
Model & \makecell[l]{Number of\\observations} & \makecell[l]{Number of\\coefficients} & AIC & \makecell[l]{Number of\\coefficients} & AIC & \makecell[l]{Number of\\coefficients} & AIC & \makecell[l]{Number of\\coefficients} & AIC\\
\midrule
\rowcolor{gray!6}  Light duty vehicle vs light duty vehicle & 114,841 & 94 & 145,390 & 97 & 143,903 & 100 & 143,896 & 100 & 144,004\\
Light duty vehicle vs light truck & 3,237 & 79 & 3,943 & 82 & 3,927 & 85 & 3,937 & 85 & 3,922\\
\rowcolor{gray!6}  Light duty vehicle vs heavy vehicle & 5,013 & 88 & 5,895 & 91 & 5,878 & 94 & 5,888 & 94 & 5,864\\
Light truck vs light duty vehicle & 3,121 & 79 & 3,885 & 82 & 3,877 & 85 & 3,881 & 85 & 3,875\\
\rowcolor{gray!6}  Light truck vs light truck & 809 & 67 & 1,170 & 70 & 1,156 & 73 & 1,162 & 73 & 1,155\\
\addlinespace
Light truck vs heavy vehicle & 198 & 64 & 288 & 67 & 281 & 70 & 287 & 70 & 286\\
\rowcolor{gray!6}  Heavy vehicle vs light duty vehicle & 4,726 & 79 & 4,326 & 84 & 4,283 & 86 & 4,268 & 87 & 4,287\\
Heavy vehicle vs light truck & 180 & 64 & 225 & 65 & 205 & 67 & 207 & 66 & 187\\
\rowcolor{gray!6}  Heavy vehicle vs heavy vehicle & 779 & 74 & 1,147 & 77 & 1,136 & 80 & 1,141 & 80 & 1,137\\
Pedestrian vs light duty vehicle & 7,176 & 88 & 2,826 & 91 & 2,821 & 91 & 2,821 & 93 & 2,827\\
\addlinespace
\rowcolor{gray!6}  Pedestrian vs light truck & 328 & 62 & 202 & 65 & 200 & 65 & 200 & 68 & 206\\
Pedestrian vs heavy vehicle & 376 & 64 & 409 & 67 & 410 & 67 & 410 & 70 & 417\\
\rowcolor{gray!6}  Bicyclist vs light duty vehicle & 3,521 & 80 & 654 & 83 & 659 & 83 & 659 & 85 & 657\\
Bicyclist vs light truck & 116 & 42 & 84 & 57 & 114 & 57 & 114 & 54 & 108\\
\rowcolor{gray!6}  Bicyclist vs heavy vehicle & - & - & - & - & - & - & - & - & -\\
\addlinespace
Motorcyclist vs light duty vehicle & 2,298 & 78 & 1,367 & 81 & 1,373 & 81 & 1,373 & 84 & 1,373\\
\rowcolor{gray!6}  Motorcyclist vs light truck & 127 & 56 & 153 & 59 & 153 & 59 & 153 & 47 & 94\\
Motorcyclist vs heavy vehicle & 62 & 43 & 88 & 45 & 90 & 46 & 92 & 51 & 102\\
\bottomrule
\multicolumn{10}{l}{\textit{Note: }}\\
\multicolumn{10}{l}{There are zero cases of Bicyclist vs heavy vehicle in the sample}\\
\end{tabular}}
\end{table}
\end{landscape}

\hypertarget{sec:assessment}{%
\section{Model assessment}\label{sec:assessment}}

In this section we report an in-depth examination of the performance of
the models. To this end, we use the models to conduct in-sample
predictions (i.e., nowcasting), using the same sample that was used to
estimate the models. In addition, we also conduct out-of-sample
predictions, using the dataset corresponding to the year 2016, processed
in identical way as the estimation sample (i.e., the 2017 dataset). This
is an example of backcasting. Broadly, we evaluate the models in two
ways: first, we compute the estimated shares of each outcome based on
the predicted probabilities; and secondly, we evaluate the predicted
outcomes.

\hypertarget{outcome-shares-based-on-predicted-probabilities}{%
\subsection{Outcome shares based on predicted
probabilities}\label{outcome-shares-based-on-predicted-probabilities}}

The shares of each outcome are calculated as the sum of the estimated
probabilities for each observation:

\begin{equation}
\label{eq:predicted-shares}
\begin{array}{rcl}
\hat{S}_{\text{PDO}} &=& \sum_{itk}\hat{P}(y_{itk}=\text{PDO})\\
\hat{S}_{\text{injury}} &=& \sum_{itk}\hat{P}(y_{itk}=\text{injury})\\
\hat{S}_{\text{fatality}} &=& \sum_{itk}\hat{P}(y_{itk}=\text{fatality})
\end{array}
\end{equation}

\noindent where \(\hat{P}(y_{itk}=h_w)\) is the estimated probability of
outcome \(h_w\) for individual \(i\) in traffic unit \(t\) and crash
\(k\). The estimated share of outcome \(h\) is \(\hat{S}_{h_w}\).

The estimated shares can be used to assess the ability of the model to
forecast for the population the total number of cases of each outcome. A
summary statistic useful to evaluate the performance is the Average
Percentage Error, or \(APE\) (see Bogue et al., 2017, p. 31), which is
calculated for each outcome as follows:

\begin{equation}
\label{eq:APE}
APE_{h_w} = \Bigg|\frac{\hat{S}_{h_w} - S_{h_w}}{S_{h_w}}\Bigg|\times 100
\end{equation}

The Weighted Average Percentage Error (\(WAPE\)) aggregates the \(APE\)
as follows:

\begin{equation}
\label{eq:WAPE}
WAPE = \frac{\sum_w^WAPE_{h_w}\times S_{h_w}}{\sum_w^WS_{h_w}}
\end{equation}

The results of this exercise are reported in Table
\ref{tab:ape-results}. Of the four full-sample models (Models 1-4), the
\(APE\) of Model 2 is lowest in the nowcasting exercise for every
outcome, with the exception of Fatality, where Model 4 produces a
considerably lower \(APE\). When the results are aggregated by means of
the \(WAPE\), Model 2 gives marginally better results than Model 4. It
is interesting to see that the two Ensemble models have lower \(APE\)
values across the board in the nowcasting exercise, and much better
\(WAPE\) than the full sample models. However, when we turn to the
results of the backcasting (out-of-sample) predictions, these results do
not hold, as the Average Percentage Errors worsen considerably,
particularly in the case of Fatality. Excellent in-sample predictions
but mediocre out-of-sample predictions could constitute evidence of
overfitting by the Ensemble models. In terms of backcasting, again Model
4 is marginally better than Model 2, especially due to more accurate
shares of No Injury.

\begin{landscape}\begin{table}

\caption{\label{tab:table-ape-results}\label{tab:ape-results}Predicted shares and average prediction errors (APE) by model (percentages)}
\centering
\fontsize{7}{9}\selectfont
\begin{tabular}[t]{lrrrrrrrrrr}
\toprule
\multicolumn{1}{c}{} & \multicolumn{3}{c}{No Injury} & \multicolumn{3}{c}{Injury} & \multicolumn{3}{c}{Fatality} & \multicolumn{1}{c}{} \\
\cmidrule(l{3pt}r{3pt}){2-4} \cmidrule(l{3pt}r{3pt}){5-7} \cmidrule(l{3pt}r{3pt}){8-10}
Model & Observed & Predicted & APE & Observed & Predicted & APE & Observed & Predicted & APE & WAPE\\
\rowcolor{gray!15}
\midrule
\addlinespace[0.3em]
\multicolumn{11}{l}{\textbf{In-sample (nowcasting using 2017 dataset, i.e., estimation dataset)}}\\
\hspace{1em}Model 1 & 78886 & 79029.00 & 0.18 & 84675 & 84533.74 & 0.17 & 950 & 948.26 & 0.18 & 0.17\\
\rowcolor{gray!15}
\hspace{1em}Model 2 & 78886 & 78928.98 & 0.05 & 84675 & 84641.94 & 0.04 & 950 & 940.08 & 1.04 & 0.05\\
\hspace{1em}Model 3 & 78886 & 79027.29 & 0.18 & 84675 & 84512.50 & 0.19 & 950 & 971.21 & 2.23 & 0.20\\
\rowcolor{gray!15}
\hspace{1em}Model 4 & 78886 & 78939.18 & 0.07 & 84675 & 84622.54 & 0.06 & 950 & 949.28 & 0.08 & 0.06\\
\hspace{1em}Model 1 Ensemble & 62413 & 62402.78 & 0.02 & 83564 & 83573.58 & 0.01 & 931 & 931.64 & 0.07 & 0.01\\
\rowcolor{gray!15}
\hspace{1em}Model 2 Ensemble & 62417 & 62407.00 & 0.02 & 83595 & 83604.14 & 0.01 & 931 & 931.86 & 0.09 & 0.01\\
\rowcolor{gray!15}
\hspace{1em}Model 3 Ensemble & 62411 & 62401.23 & 0.02 & 83596 & 83604.71 & 0.01 & 933 & 934.06 & 0.11 & 0.01\\
\hspace{1em}Model 4 Ensemble & 62405 & 62395.28 & 0.02 & 83578 & 83586.75 & 0.01 & 932 & 932.97 & 0.10 & 0.01\\
\rowcolor{gray!15}
\addlinespace[0.3em]
\multicolumn{11}{l}{\textbf{Out-of-sample (backcasting using 2016 dataset)}}\\
\hspace{1em}Model 1 & 96860 & 96364.67 & 0.51 & 101605 & 102002.59 & 0.39 & 1109 & 1206.74 & 8.81 & 0.50\\
\rowcolor{gray!15}
\hspace{1em}Model 2 & 96860 & 96361.41 & 0.51 & 101605 & 102112.08 & 0.50 & 1109 & 1100.51 & 0.77 & 0.51\\
\hspace{1em}Model 3 & 96860 & 96354.01 & 0.52 & 101605 & 102086.18 & 0.47 & 1109 & 1133.82 & 2.24 & 0.51\\
\rowcolor{gray!15}
\hspace{1em}Model 4 & 96860 & 96325.85 & 0.55 & 101605 & 102136.72 & 0.52 & 1109 & 1111.43 & 0.22 & 0.54\\
\hspace{1em}Model 1 Ensemble & 77457 & 76822.49 & 0.82 & 100013 & 100580.60 & 0.57 & 1072 & 1138.91 & 6.24 & 0.71\\
\rowcolor{gray!15}
\hspace{1em}Model 2 Ensemble & 77459 & 76799.11 & 0.85 & 100049 & 100630.48 & 0.58 & 1071 & 1149.41 & 7.32 & 0.74\\
\hspace{1em}Model 3 Ensemble & 77459 & 76786.76 & 0.87 & 100050 & 100644.29 & 0.59 & 1072 & 1149.95 & 7.27 & 0.75\\
\rowcolor{gray!15}
Model 4 Ensemble & 77461 & 76766.08 & 0.90 & 100029 & 100630.21 & 0.60 & 1070 & 1163.71 & 8.76 & 0.78\\
\bottomrule
\end{tabular}
\end{table}
\end{landscape}

\hypertarget{outcome-frequency-based-on-predicted-classes}{%
\subsection{Outcome frequency based on predicted
classes}\label{outcome-frequency-based-on-predicted-classes}}

Words go here.

Verification statistics used are summarized in Table
\ref{tab:verification-statistics}.

\begin{landscape}\begin{table}

\caption{\label{tab:table-verification-statistics}\label{tab:verification-statistics}Verification statistics}
\centering
\resizebox{\linewidth}{!}{
\fontsize{7}{9}\selectfont
\begin{tabular}[t]{l>{\raggedright\arraybackslash}p{30em}>{\raggedright\arraybackslash}p{30em}}
\toprule
Statistic & Description & Notes\\
\midrule
\rowcolor{gray!6}  Percent Correct ($PC$) & Total hits and correct rejections divided by number of cases & Strongly influenced by most common category\\
Percent Correct by Class ($PC_c$) & Same as Percent Correct but by category & Strongly influenced by most common category\\
\rowcolor{gray!6}  Bias ($B$) & Total predicted by category, divided by total observed by category & $B>1$: class is overpredicted; $B<1$: class is underpredicted\\
Critical Success Index ($CSI$) & Total hits divided by total hits + false alarms + misses & $CSI = 1$: perfect score; $CSI = 0$: no skill\\
\rowcolor{gray!6}  Probability of False Detection ($F$) & Proportion of no events forecast as yes; sensitive to false alarms but ignores misses & $F = 0$: perfect score\\
\addlinespace
Probability of Detection ($POD$) & Total hits divided by total observed by class & $POD = 1$: perfect score\\
\rowcolor{gray!6}  False Alarm Ratio ($FAR$) & Total false alarms divided by total forecast yes by class; measures fraction of predicted yes that did not occur & $FAR = 0$: perfect score\\
Heidke Skill Score ($HSS$) & Fraction of correct predictions after removing predictions attributable to chance; measures fractional improvement over random; tends to reward conservative forecasts & $HSS = 1$: perfect score; $HSS = 0$: no skill; $HSS < 0$: random is better\\
\rowcolor{gray!6}  Peirce Skill Score ($PSS$) & Combines $POD$ and $F$; measures ability to separate yes events from no events; tends to reward conservative forecasts & $PSS = 1$: perfect score; $PSS = 0$: no skill\\
Gerrity Score ($GS$) & Measures accuracy of predicting the correct category, relative to random; tends to reward correct forecasts of less likely category & $GS = 1$: perfect score; $GS = 0$: no skill\\
\bottomrule
\end{tabular}}
\end{table}
\end{landscape}

We next evaluate the outcomes of the nowcast using an array of
verification statistics. See Table
\ref{tab:nowcast-outcomes-assessment}. We next evaluate the outcomes of
the nowcast using an array of verification statistics. See Table
\ref{tab:backcast-outcomes-assessment}.

\begin{table}[!h]

\caption{\label{tab:nowcast-outcomes-assessment}\label{tab:nowcast-outcomes-assessment}Assessment of in-sample outcomes (nowcasting using 2017 dataset, i.e., estimation dataset)}
\centering
\resizebox{\linewidth}{!}{
\fontsize{7}{9}\selectfont
\begin{tabular}[t]{lrrrrrrrrrrrrr}
\toprule
\multicolumn{1}{c}{Observed} & \multicolumn{3}{c}{Predicted Outcome} & \multicolumn{10}{c}{Verification Statistics} \\
\cmidrule(l{3pt}r{3pt}){1-1} \cmidrule(l{3pt}r{3pt}){2-4} \cmidrule(l{3pt}r{3pt}){5-14}
Outcome & No Injury & Injury & Fatality & \makecell[l]{Percent\\Correct} & \makecell[l]{Percent\\Correct\\by Class} & Bias$^1$ & \makecell[l]{Critical\\Success\\Index$^2$} & \makecell[l]{Probability of\\False\\Detection$^3$} & \makecell[l]{Probability\\of\\Detection$^4$} & \makecell[l]{False\\Alarm\\Ratio$^5$} & \makecell[l]{Heidke\\Skill\\Score$^6$} & \makecell[l]{Peirce\\Skill\\Score$^7$} & \makecell[l]{Gerrity\\Score$^8$}\\
\midrule
\addlinespace[0.3em]
\multicolumn{14}{l}{\textbf{Model 1}}\\
\hspace{1em}No Injury & 50652 & 22503 & 150 &  & 69.0677 & 0.9293 & 0.4988 & 0.2646 & 0.6421 & 0.3090 &  &  & \\

\hspace{1em}Injury & 28232 & 62121 & 797 &  & 68.6446 & 1.0765 & 0.5463 & 0.3636 & 0.7336 & 0.3185 &  &  & \\

Fatality & 2 & 51 & 3 & \multirow{-3}{*}{\raggedleft\arraybackslash 68.5523} & 99.3921 & 0.0589 & 0.0030 & 0.0003 & 0.0032 & 0.9464 & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3725} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3696} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.1902}\\
\cmidrule{1-14}
\addlinespace[0.3em]
\multicolumn{14}{l}{\textbf{Model 2}}\\
\hspace{1em}No Injury & 51531 & 17137 & 85 &  & 72.9033 & 0.8715 & 0.5362 & 0.2011 & 0.6532 & 0.2505 &  &  & \\

\hspace{1em}Injury & 27355 & 67514 & 864 &  & 72.4152 & 1.1306 & 0.5980 & 0.3535 & 0.7973 & 0.2948 &  &  & \\

Fatality & 0 & 24 & 1 & \multirow{-3}{*}{\raggedleft\arraybackslash 72.3636} & 99.4086 & 0.0263 & 0.0010 & 0.0001 & 0.0011 & 0.9600 & \multirow{-3}{*}{\raggedleft\arraybackslash 0.4474} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.4429} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.2265}\\
\cmidrule{1-14}
\addlinespace[0.3em]
\multicolumn{14}{l}{\textbf{Model 3}}\\
\hspace{1em}No Injury & 51101 & 17296 & 79 &  & 72.5489 & 0.8680 & 0.5309 & 0.2029 & 0.6478 & 0.2537 &  &  & \\

\hspace{1em}Injury & 27785 & 67338 & 868 &  & 72.0444 & 1.1336 & 0.5942 & 0.3589 & 0.7953 & 0.2985 &  &  & \\

Fatality & 0 & 41 & 3 & \multirow{-3}{*}{\raggedleft\arraybackslash 71.9964} & 99.3994 & 0.0463 & 0.0030 & 0.0003 & 0.0032 & 0.9318 & \multirow{-3}{*}{\raggedleft\arraybackslash 0.4400} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.4356} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.2239}\\
\cmidrule{1-14}
\addlinespace[0.3em]
\multicolumn{14}{l}{\textbf{Model 4}}\\
\hspace{1em}No Injury & 51575 & 17318 & 84 &  & 72.8207 & 0.8744 & 0.5356 & 0.2032 & 0.6538 & 0.2523 &  &  & \\

\hspace{1em}Injury & 27311 & 67334 & 863 &  & 72.3332 & 1.1279 & 0.5967 & 0.3529 & 0.7952 & 0.2950 &  &  & \\

Fatality & 0 & 23 & 3 & \multirow{-3}{*}{\raggedleft\arraybackslash 72.2821} & 99.4104 & 0.0274 & 0.0031 & 0.0001 & 0.0032 & 0.8846 & \multirow{-3}{*}{\raggedleft\arraybackslash 0.4458} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.4414} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.2268}\\
\cmidrule{1-14}
\addlinespace[0.3em]
\multicolumn{14}{l}{\textbf{Model 1 Ensemble}}\\
\hspace{1em}No Injury & 34664 & 16434 & 63 &  & 69.8818 & 0.8197 & 0.4393 & 0.1952 & 0.5554 & 0.3225 &  &  & \\

\hspace{1em}Injury & 27749 & 67120 & 829 &  & 69.3536 & 1.1452 & 0.5985 & 0.4512 & 0.8032 & 0.2986 &  &  & \\

Fatality & 0 & 10 & 39 & \multirow{-3}{*}{\raggedleft\arraybackslash 69.3107} & 99.3860 & 0.0526 & 0.0414 & 0.0001 & 0.0419 & 0.2041 & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3626} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3521} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.2010}\\
\cmidrule{1-14}
\addlinespace[0.3em]
\multicolumn{14}{l}{\textbf{Model 2 Ensemble}}\\
\hspace{1em}No Injury & 35443 & 16145 & 60 &  & 70.6151 & 0.8275 & 0.4508 & 0.1917 & 0.5678 & 0.3138 &  &  & \\

\hspace{1em}Injury & 26974 & 67437 & 829 &  & 70.0830 & 1.1393 & 0.6054 & 0.4389 & 0.8067 & 0.2919 &  &  & \\

Fatality & 0 & 13 & 42 & \multirow{-3}{*}{\raggedleft\arraybackslash 70.0421} & 99.3862 & 0.0591 & 0.0445 & 0.0001 & 0.0451 & 0.2364 & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3784} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3678} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.2106}\\
\cmidrule{1-14}
\addlinespace[0.3em]
\multicolumn{14}{l}{\textbf{Model 3 Ensemble}}\\
\hspace{1em}No Injury & 35498 & 16204 & 60 &  & 70.6159 & 0.8294 & 0.4512 & 0.1924 & 0.5688 & 0.3142 &  &  & \\

\hspace{1em}Injury & 26913 & 67379 & 828 &  & 70.0844 & 1.1379 & 0.6052 & 0.4379 & 0.8060 & 0.2916 &  &  & \\

Fatality & 0 & 13 & 45 & \multirow{-3}{*}{\raggedleft\arraybackslash 70.0436} & 99.3868 & 0.0622 & 0.0476 & 0.0001 & 0.0482 & 0.2241 & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3786} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3681} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.2123}\\
\cmidrule{1-14}
\addlinespace[0.3em]
\multicolumn{14}{l}{\textbf{Model 4 Ensemble}}\\
\hspace{1em}No Injury & 35553 & 16297 & 59 &  & 70.5898 & 0.8318 & 0.4514 & 0.1935 & 0.5697 & 0.3151 &  &  & \\

\hspace{1em}Injury & 26852 & 67271 & 827 &  & 70.0602 & 1.1361 & 0.6046 & 0.4370 & 0.8049 & 0.2915 &  &  & \\

Fatality & 0 & 10 & 46 & \multirow{-3}{*}{\raggedleft\arraybackslash 70.0201} & 99.3901 & 0.0601 & 0.0488 & 0.0001 & 0.0494 & 0.1786 & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3783} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3679} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.2127}\\
\bottomrule
\multicolumn{14}{l}{\textit{Notes: }}\\
\multicolumn{14}{l}{\textsuperscript{1} $B>1$: class is overpredicted; $B<1$: class is underpredicted; }\\
\multicolumn{14}{l}{\textsuperscript{2} $CSI = 1$: perfect score; $CSI = 0$: no skill; }\\
\multicolumn{14}{l}{\textsuperscript{3} $F = 0$: perfect score; }\\
\multicolumn{14}{l}{\textsuperscript{4} $POD = 1$: perfect score; }\\
\multicolumn{14}{l}{\textsuperscript{5} $FAR = 0$: perfect score; }\\
\multicolumn{14}{l}{\textsuperscript{6} $HSS = 1$: perfect score; $HSS = 0$: no skill; $HSS < 0$: random is better; }\\
\multicolumn{14}{l}{\textsuperscript{7} $PSS = 1$: perfect score; $PSS = 0$: no skill; }\\
\multicolumn{14}{l}{\textsuperscript{8} $GS = 1$: perfect score; $GS = 0$: no skill.}\\
\end{tabular}}
\end{table}

\begin{table}[!h]

\caption{\label{tab:backcast-outcomes-assessment}\label{tab:nowcast-outcomes-assessment}Assessment of out-of-sample outcomes (backcasting using 2016 dataset)}
\centering
\resizebox{\linewidth}{!}{
\fontsize{7}{9}\selectfont
\resizebox{\linewidth}{!}{
\begin{tabular}[t]{lrrrrrrrrrrrrr}
\toprule
\multicolumn{1}{c}{Observed} & \multicolumn{3}{c}{Predicted Outcome} & \multicolumn{10}{c}{Verification Statistics} \\
\cmidrule(l{3pt}r{3pt}){1-1} \cmidrule(l{3pt}r{3pt}){2-4} \cmidrule(l{3pt}r{3pt}){5-14}
Outcome & No Injury & Injury & Fatality & \makecell[l]{Percent\\Correct} & \makecell[l]{Percent\\Correct\\by Class} & Bias$^1$ & \makecell[l]{Critical\\Success\\Index$^2$} & \makecell[l]{Probability of\\False\\Detection$^3$} & \makecell[l]{Probability\\of\\Detection$^4$} & \makecell[l]{False\\Alarm\\Ratio$^5$} & \makecell[l]{Heidke\\Skill\\Score$^6$} & \makecell[l]{Peirce\\Skill\\Score$^7$} & \makecell[l]{Gerrity\\Score$^8$}\\
\midrule
\addlinespace[0.3em]
\multicolumn{14}{l}{\textbf{Model 1}}\\
\hspace{1em}No Injury & 61684 & 27447 & 184 &  & 68.5295 & 0.9221 & 0.4955 & 0.2690 & 0.6368 & 0.3094 &  &  & \\

\hspace{1em}Injury & 35171 & 74073 & 915 &  & 68.1231 & 1.0842 & 0.5380 & 0.3683 & 0.7290 & 0.3276 &  &  & \\

Fatality & 5 & 85 & 10 & \multirow{-3}{*}{\raggedleft\arraybackslash 68.0284} & 99.4042 & 0.0902 & 0.0083 & 0.0005 & 0.0090 & 0.9000 & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3628} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3604} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.1882}\\
\cmidrule{1-14}
\addlinespace[0.3em]
\multicolumn{14}{l}{\textbf{Model 2}}\\
\hspace{1em}No Injury & 62735 & 21013 & 106 &  & 72.3190 & 0.8657 & 0.5317 & 0.2056 & 0.6477 & 0.2519 &  &  & \\

\hspace{1em}Injury & 34125 & 80569 & 996 &  & 71.8616 & 1.1386 & 0.5893 & 0.3585 & 0.7930 & 0.3036 &  &  & \\

Fatality & 0 & 23 & 7 & \multirow{-3}{*}{\raggedleft\arraybackslash 71.8085} & 99.4363 & 0.0271 & 0.0062 & 0.0001 & 0.0063 & 0.7667 & \multirow{-3}{*}{\raggedleft\arraybackslash 0.4372} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.4335} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.2241}\\
\cmidrule{1-14}
\addlinespace[0.3em]
\multicolumn{14}{l}{\textbf{Model 3}}\\
\hspace{1em}No Injury & 62248 & 21133 & 107 &  & 72.0144 & 0.8619 & 0.5271 & 0.2068 & 0.6427 & 0.2544 &  &  & \\

\hspace{1em}Injury & 34610 & 80433 & 996 &  & 71.5504 & 1.1421 & 0.5862 & 0.3634 & 0.7916 & 0.3068 &  &  & \\

Fatality & 2 & 39 & 6 & \multirow{-3}{*}{\raggedleft\arraybackslash 71.4958} & 99.4268 & 0.0424 & 0.0052 & 0.0002 & 0.0054 & 0.8723 & \multirow{-3}{*}{\raggedleft\arraybackslash 0.4310} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.4274} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.2205}\\
\cmidrule{1-14}
\addlinespace[0.3em]
\multicolumn{14}{l}{\textbf{Model 4}}\\
\hspace{1em}No Injury & 62788 & 21246 & 102 &  & 72.2309 & 0.8686 & 0.5312 & 0.2078 & 0.6482 & 0.2537 &  &  & \\

\hspace{1em}Injury & 34071 & 80332 & 1000 &  & 71.7679 & 1.1358 & 0.5878 & 0.3580 & 0.7906 & 0.3039 &  &  & \\

Fatality & 1 & 27 & 7 & \multirow{-3}{*}{\raggedleft\arraybackslash 71.7163} & 99.4338 & 0.0316 & 0.0062 & 0.0001 & 0.0063 & 0.8000 & \multirow{-3}{*}{\raggedleft\arraybackslash 0.4355} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.4318} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.2233}\\
\cmidrule{1-14}
\addlinespace[0.3em]
\multicolumn{14}{l}{\textbf{Model 1 Ensemble}}\\
\hspace{1em}No Injury & 42896 & 20230 & 95 &  & 69.2588 & 0.8162 & 0.4387 & 0.2011 & 0.5538 & 0.3215 &  &  & \\

\hspace{1em}Injury & 34546 & 79692 & 962 &  & 68.7306 & 1.1519 & 0.5880 & 0.4522 & 0.7968 & 0.3082 &  &  & \\

Fatality & 15 & 91 & 15 & \multirow{-3}{*}{\raggedleft\arraybackslash 68.6690} & 99.3486 & 0.1129 & 0.0127 & 0.0006 & 0.0140 & 0.8760 & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3539} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3447} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.1831}\\
\cmidrule{1-14}
\addlinespace[0.3em]
\multicolumn{14}{l}{\textbf{Model 2 Ensemble}}\\
\hspace{1em}No Injury & 43486 & 19937 & 95 &  & 69.7585 & 0.8200 & 0.4461 & 0.1981 & 0.5614 & 0.3154 &  &  & \\

\hspace{1em}Injury & 33953 & 80009 & 961 &  & 69.2271 & 1.1487 & 0.5928 & 0.4446 & 0.7997 & 0.3038 &  &  & \\

Fatality & 20 & 103 & 15 & \multirow{-3}{*}{\raggedleft\arraybackslash 69.1627} & 99.3398 & 0.1289 & 0.0126 & 0.0007 & 0.0140 & 0.8913 & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3644} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3551} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.1883}\\
\cmidrule{1-14}
\addlinespace[0.3em]
\multicolumn{14}{l}{\textbf{Model 3 Ensemble}}\\
\hspace{1em}No Injury & 43526 & 20033 & 92 &  & 69.7291 & 0.8217 & 0.4460 & 0.1990 & 0.5619 & 0.3162 &  &  & \\

\hspace{1em}Injury & 33915 & 79915 & 964 &  & 69.1938 & 1.1474 & 0.5923 & 0.4441 & 0.7988 & 0.3038 &  &  & \\

Fatality & 18 & 102 & 16 & \multirow{-3}{*}{\raggedleft\arraybackslash 69.1322} & 99.3415 & 0.1269 & 0.0134 & 0.0007 & 0.0149 & 0.8824 & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3639} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3546} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.1885}\\
\cmidrule{1-14}
\addlinespace[0.3em]
\multicolumn{14}{l}{\textbf{Model 4 Ensemble}}\\
\hspace{1em}No Injury & 43561 & 20160 & 94 &  & 69.6718 & 0.8238 & 0.4458 & 0.2003 & 0.5624 & 0.3174 &  &  & \\

\hspace{1em}Injury & 33875 & 79762 & 959 &  & 69.1415 & 1.1456 & 0.5914 & 0.4436 & 0.7974 & 0.3040 &  &  & \\

Fatality & 25 & 107 & 17 & \multirow{-3}{*}{\raggedleft\arraybackslash 69.0748} & 99.3364 & 0.1393 & 0.0141 & 0.0007 & 0.0159 & 0.8859 & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3629} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.3538} & \multirow{-3}{*}{\raggedleft\arraybackslash 0.1886}\\
\bottomrule
\multicolumn{14}{l}{\textit{Notes: }}\\
\multicolumn{14}{l}{\textsuperscript{1} $B>1$: class is overpredicted; $B<1$: class is underpredicted; }\\
\multicolumn{14}{l}{\textsuperscript{2} $CSI = 1$: perfect score; $CSI = 0$: no skill; }\\
\multicolumn{14}{l}{\textsuperscript{3} $F = 0$: perfect score; }\\
\multicolumn{14}{l}{\textsuperscript{4} $POD = 1$: perfect score; }\\
\multicolumn{14}{l}{\textsuperscript{5} $FAR = 0$: perfect score; }\\
\multicolumn{14}{l}{\textsuperscript{6} $HSS = 1$: perfect score; $HSS = 0$: no skill; $HSS < 0$: random is better; }\\
\multicolumn{14}{l}{\textsuperscript{7} $PSS = 1$: perfect score; $PSS = 0$: no skill; }\\
\multicolumn{14}{l}{\textsuperscript{8} $GS = 1$: perfect score; $GS = 0$: no skill.}\\
\end{tabular}}}
\end{table}

\hypertarget{sec:further-considerations}{%
\section{Further considerations}\label{sec:further-considerations}}

Here I plan to discuss the applicability of the modelling strategy to
advanced modelling techniques (partial proportional odds, heterogeneity,
hierarchical models, etc.)

\hypertarget{sec:concluding-remarks}{%
\section{Concluding remarks}\label{sec:concluding-remarks}}

Different modelling strategies can be used to model complex
hierarchical, multievent outcomes such as the severity of injuries
following a collision. The objective of this paper was to assess the
performance of different strategies to model opponent effects in
two-vehicle crashes. In broad terms, three strategies were considered:
1) incorporating opponent-level variables in the model; 2) single-
versus multi-level model specifications; and 3) sample subsetting and
estimation of separate models for different types of individual-opponent
interactions.

The results of the empirical assessment strongly suggest that
incorporating opponent effects can greatly improve the fit and
predictive performance of a model. There is some evidence that
subsetting the sample can improve the results in some isolated
situations (e.g., when modelling the severity of crashes involving
active travellers or motorcyclists), possibly at the risk of
overfitting. In this paper we did not compare individual models in our
Ensemble approach, but we suggest that this is an avenue for future
research.

In terms of the full sample models, the evidence was not conclusive in
favor of a single-level model with opponent variables (Model 2), or a
hierarchical model with individual-opponent interactions (Model 4). On
the one hand, the AIC tended to favor the

\hypertarget{references}{%
\section*{References}\label{references}}
\addcontentsline{toc}{section}{References}

\hypertarget{refs}{}
\leavevmode\hypertarget{ref-Amoh2017effect}{}%
Amoh-Gyimah, R., Aidoo, E.N., Akaateba, M.A., Appiah, S.K., 2017. The
effect of natural and built environmental characteristics on
pedestrian-vehicle crash severity in ghana. International Journal of
Injury Control and Safety Promotion 24, 459--468.
doi:\href{https://doi.org/10.1080/17457300.2016.1232274}{10.1080/17457300.2016.1232274}

\leavevmode\hypertarget{ref-Aziz2013exploring}{}%
Aziz, H.M.A., Ukkusuri, S.V., Hasan, S., 2013. Exploring the
determinants of pedestrian-vehicle crash severity in new york city.
Accident Analysis and Prevention 50, 1298--1309.
doi:\href{https://doi.org/10.1016/j.aap.2012.09.034}{10.1016/j.aap.2012.09.034}

\leavevmode\hypertarget{ref-Bogue2017modified}{}%
Bogue, S., Paleti, R., Balan, L., 2017. A modified rank ordered logit
model to analyze injury severity of occupants in multivehicle crashes.
Analytic Methods in Accident Research 14, 22--40.
doi:\href{https://doi.org/10.1016/j.amar.2017.03.001}{10.1016/j.amar.2017.03.001}

\leavevmode\hypertarget{ref-Casetti1972generating}{}%
Casetti, E., 1972. Generating models by the expansion method:
Applications to geographic research. Geographical Analysis 4, 81--91.

\leavevmode\hypertarget{ref-Chang2006analysis}{}%
Chang, L.Y., Wang, H.W., 2006. Analysis of traffic injury severity: An
application of non-parametric classification tree techniques. Accident
Analysis and Prevention 38, 1019--1027.
doi:\href{https://doi.org/10.1016/j.aap.2006.04.009}{10.1016/j.aap.2006.04.009}

\leavevmode\hypertarget{ref-Chen2019investigation}{}%
Chen, F., Song, M.T., Ma, X.X., 2019. Investigation on the injury
severity of drivers in rear-end collisions between cars using a random
parameters bivariate ordered probit model. International Journal of
Environmental Research and Public Health 16.
doi:\href{https://doi.org/10.3390/ijerph16142632}{10.3390/ijerph16142632}

\leavevmode\hypertarget{ref-Chiou2013modeling}{}%
Chiou, Y.C., Hwang, C.C., Chang, C.C., Fu, C., 2013. Modeling
two-vehicle crash severity by a bivariate generalized ordered probit
approach. Accident Analysis and Prevention 51, 175--184.
doi:\href{https://doi.org/10.1016/j.aap.2012.11.008}{10.1016/j.aap.2012.11.008}

\leavevmode\hypertarget{ref-Devlin2019road}{}%
Devlin, A., Beck, B., Simpson, P.M., Ekegren, C.L., Giummarra, M.J.,
Edwards, E.R., Cameron, P.A., Liew, S., Oppy, A., Richardson, M., Page,
R., Gabbe, B.J., 2019. The road to recovery for vulnerable road users
hospitalised for orthopaedic injury following an on-road crash. Accident
Analysis and Prevention 132, 10.
doi:\href{https://doi.org/10.1016/j.aap.2019.105279}{10.1016/j.aap.2019.105279}

\leavevmode\hypertarget{ref-Dissanayake2002factors}{}%
Dissanayake, S., Lu, J.J., 2002. Factors influential in making an injury
severity difference to older drivers involved in fixed object-passenger
car crashes. Accident Analysis and Prevention 34, 609--618.
doi:\href{https://doi.org/10.1016/s0001-4575(01)00060-4}{10.1016/s0001-4575(01)00060-4}

\leavevmode\hypertarget{ref-Duddu2018modeling}{}%
Duddu, V.R., Penmetsa, P., Pulugurtha, S.S., 2018. Modeling and
comparing injury severity of at-fault and not at-fault drivers in
crashes. Accident Analysis and Prevention 120, 55--63.
doi:\href{https://doi.org/10.1016/j.aap.2018.07.036}{10.1016/j.aap.2018.07.036}

\leavevmode\hypertarget{ref-Effati2015geospatial}{}%
Effati, M., Thill, J.C., Shabani, S., 2015. Geospatial and machine
learning techniques for wicked social science problems: Analysis of
crash severity on a regional highway corridor. Journal of Geographical
Systems 17, 107--135.
doi:\href{https://doi.org/10.1007/s10109-015-0210-x}{10.1007/s10109-015-0210-x}

\leavevmode\hypertarget{ref-Gong2017modeling}{}%
Gong, L.F., Fan, W.D., 2017. Modeling single-vehicle run-off-road crash
severity in rural areas: Accounting for unobserved heterogeneity and age
difference. Accident Analysis and Prevention 101, 124--134.
doi:\href{https://doi.org/10.1016/j.aap.2017.02.014}{10.1016/j.aap.2017.02.014}

\leavevmode\hypertarget{ref-Haleem2013effect}{}%
Haleem, K., Gan, A., 2013. Effect of driver's age and side of impact on
crash severity along urban freeways: A mixed logit approach. Journal of
Safety Research 46, 67--76.
doi:\href{https://doi.org/10.1016/j.jsr.2013.04.002}{10.1016/j.jsr.2013.04.002}

\leavevmode\hypertarget{ref-Hanson2013severity}{}%
Hanson, C.S., Noland, R.B., Brown, C., 2013. The severity of pedestrian
crashes: An analysis using google street view imagery. Journal of
Transport Geography 33, 42--53.
doi:\href{https://doi.org/10.1016/j.jtrangeo.2013.09.002}{10.1016/j.jtrangeo.2013.09.002}

\leavevmode\hypertarget{ref-Hedeker1994random}{}%
Hedeker, D., Gibbons, R.D., 1994. A random-effects ordinal
regression-model for multilevel analysis. Biometrics 50, 933--944.

\leavevmode\hypertarget{ref-Iranitalab2017comparison}{}%
Iranitalab, A., Khattak, A., 2017. Comparison of four statistical and
machine learning methods for crash severity prediction. Accident
Analysis and Prevention 108, 27--36.
doi:\href{https://doi.org/10.1016/j.aap.2017.08.008}{10.1016/j.aap.2017.08.008}

\leavevmode\hypertarget{ref-Islam2014comprehensive}{}%
Islam, S., Jones, S.L., Dye, D., 2014. Comprehensive analysis of single-
and multi-vehicle large truck at-fault crashes on rural and urban
roadways in alabama. Accident Analysis \& Prevention 67, 148--158.
doi:\href{https://doi.org/https://doi.org/10.1016/j.aap.2014.02.014}{https://doi.org/10.1016/j.aap.2014.02.014}

\leavevmode\hypertarget{ref-Khan2015exploring}{}%
Khan, G., Bill, A.R., Noyce, D.A., 2015. Exploring the feasibility of
classification trees versus ordinal discrete choice models for analyzing
crash severity. Transportation Research Part C-Emerging Technologies 50,
86--96.
doi:\href{https://doi.org/10.1016/j.trc.2014.10.003}{10.1016/j.trc.2014.10.003}

\leavevmode\hypertarget{ref-Kim2013driver}{}%
Kim, J.K., Ulfarsson, G.F., Kim, S., Shankar, V.N., 2013. Driver-injury
severity in single-vehicle crashes in california: A mixed logit analysis
of heterogeneity due to age and gender. Accident Analysis and Prevention
50, 1073--1081.
doi:\href{https://doi.org/10.1016/j.aap.2012.08.011}{10.1016/j.aap.2012.08.011}

\leavevmode\hypertarget{ref-Kim1995personal}{}%
Kim, K., Nitz, L., Richardson, J., Li, L., 1995. PERSONAL and behavioral
predictors of automobile crash and injury severity. Accident Analysis
and Prevention 27, 469--481.
doi:\href{https://doi.org/10.1016/0001-4575(95)00001-g}{10.1016/0001-4575(95)00001-g}

\leavevmode\hypertarget{ref-Lee2014analysis}{}%
Lee, C., Li, X.C., 2014. Analysis of injury severity of drivers involved
in single- and two-vehicle crashes on highways in ontario. Accident
Analysis and Prevention 71, 286--295.
doi:\href{https://doi.org/10.1016/j.aap.2014.06.008}{10.1016/j.aap.2014.06.008}

\leavevmode\hypertarget{ref-Li2017interplay}{}%
Li, L., Hasnine, M.S., Habib, K.M.N., Persaud, B., Shalaby, A., 2017.
Investigating the interplay between the attributes of at-fault and
not-at-fault drivers and the associated impacts on crash injury
occurrence and severity level. Journal of Transportation Safety \&
Security 9, 439--456.
doi:\href{https://doi.org/10.1080/19439962.2016.1237602}{10.1080/19439962.2016.1237602}

\leavevmode\hypertarget{ref-Ma2008multivariate}{}%
Ma, J.M., Kockelman, K.M., Damien, P., 2008. A multivariate
poisson-lognormal regression model for prediction of crash counts by
severity, using bayesian methods. Accident Analysis and Prevention 40,
964--975.
doi:\href{https://doi.org/10.1016/j.aap.2007.11.002}{10.1016/j.aap.2007.11.002}

\leavevmode\hypertarget{ref-Maddala1986limited}{}%
Maddala, G.S., 1986. Limited-dependent and qualitative variables in
econometrics. Cambridge university press.

\leavevmode\hypertarget{ref-McArthur2014spatial}{}%
McArthur, A., Savolainen, P.T., Gates, T.J., 2014. Spatial analysis of
child pedestrian and bicycle crashes development of safety performance
function for areas adjacent to schools. Transportation Research Record
57--63. doi:\href{https://doi.org/10.3141/2465-08}{10.3141/2465-08}

\leavevmode\hypertarget{ref-Merlin2007stress}{}%
Merlin, E.P.R., Gonzalez-Forteza, C., Lira, L.R., Tapia, J.A.J., 2007.
Post-traumatic stress disorder in patients with non intentional injuries
caused by road traffic accidents. Salud Mental 30, 43--48.

\leavevmode\hypertarget{ref-Montella2013crash}{}%
Montella, A., Andreassen, D., Tarko, A.P., Turner, S., Mauriello, F.,
Imbriani, L.L., Romero, M.A., 2013. Crash databases in australasia, the
european union, and the united states review and prospects for
improvement. Transportation Research Record 128--136.
doi:\href{https://doi.org/10.3141/2386-15}{10.3141/2386-15}

\leavevmode\hypertarget{ref-Mooradian2013analysis}{}%
Mooradian, J., Ivan, J.N., Ravishanker, N., Hu, S., 2013. Analysis of
driver and passenger crash injury severity using partial proportional
odds models. Accident Analysis and Prevention 58, 53--58.
doi:\href{https://doi.org/10.1016/j.aap.2013.04.022}{10.1016/j.aap.2013.04.022}

\leavevmode\hypertarget{ref-Mussone2017analysis}{}%
Mussone, L., Bassani, M., Masci, P., 2017. Analysis of factors affecting
the severity of crashes in urban road intersections. Accident Analysis
and Prevention 103, 112--122.
doi:\href{https://doi.org/10.1016/j.aap.2017.04.007}{10.1016/j.aap.2017.04.007}

\leavevmode\hypertarget{ref-Obeng2011gender}{}%
Obeng, K., 2011. Gender differences in injury severity risks in crashes
at signalized intersections. Accident Analysis and Prevention 43,
1521--1531.
doi:\href{https://doi.org/10.1016/j.aap.2011.03.004}{10.1016/j.aap.2011.03.004}

\leavevmode\hypertarget{ref-Osman2018injury}{}%
Osman, M., Mishra, S., Paleti, R., 2018. Injury severity analysis of
commercially-licensed drivers in single-vehicle crashes: Accounting for
unobserved heterogeneity and age group differences. Accident Analysis
and Prevention 118, 289--300.
doi:\href{https://doi.org/10.1016/j.aap.2018.05.004}{10.1016/j.aap.2018.05.004}

\leavevmode\hypertarget{ref-Peek-Asa2010teenage}{}%
Peek-Asa, C., Britton, C., Young, T., Pawlovich, M., Falb, S., 2010.
Teenage driver crash incidence and factors influencing crash injury by
rurality. Journal of Safety Research 41, 487--492.
doi:\href{https://doi.org/10.1016/j.jsr.2010.10.002}{10.1016/j.jsr.2010.10.002}

\leavevmode\hypertarget{ref-Pelissier2019medical}{}%
Pelissier, C., Fort, E., Fontana, L., Hours, M., n.d. Medical and
socio-occupational predictive factors of psychological distress 5 years
after a road accident: A prospective study. Social Psychiatry and
Psychiatric Epidemiology 13.
doi:\href{https://doi.org/10.1007/s00127-019-01780-0}{10.1007/s00127-019-01780-0}

\leavevmode\hypertarget{ref-Penmetsa2017examining}{}%
Penmetsa, P., Pulugurtha, S.S., Duddu, V.R., 2017. Examining injury
severity of not-at-fault drivers in two-vehicle crashes. Transportation
Research Record 164--173.
doi:\href{https://doi.org/10.3141/2659-18}{10.3141/2659-18}

\leavevmode\hypertarget{ref-Rakotonirainy2012older}{}%
Rakotonirainy, A., Steinhardt, D., Delhomme, P., Darvell, M., Schramm,
A., 2012. Older drivers' crashes in queensland, australia. Accident
Analysis and Prevention 48, 423--429.
doi:\href{https://doi.org/10.1016/j.aap.2012.02.016}{10.1016/j.aap.2012.02.016}

\leavevmode\hypertarget{ref-Rana2010copula}{}%
Rana, T.A., Sikder, S., Pinjari, A.R., 2010. Copula-based method for
addressing endogeneity in models of severity of traffic crash injuries
application to two-vehicle crashes. Transportation Research Record
75--87. doi:\href{https://doi.org/10.3141/2147-10}{10.3141/2147-10}

\leavevmode\hypertarget{ref-Regev2018crash}{}%
Regev, S., Rolison, J.J., Moutari, S., 2018. Crash risk by driver age,
gender, and time of day using a new exposure methodology. Journal of
Safety Research 66, 131--140.
doi:\href{https://doi.org/10.1016/j.jsr.2018.07.002}{10.1016/j.jsr.2018.07.002}

\leavevmode\hypertarget{ref-Rifaat2007accident}{}%
Rifaat, S.M., Chin, H.C., 2007. Accident severity analysis using ordered
probit model. Journal of Advanced Transportation 41, 91--114.
doi:\href{https://doi.org/10.1002/atr.5670410107}{10.1002/atr.5670410107}

\leavevmode\hypertarget{ref-Salon2018determinants}{}%
Salon, D., McIntyre, A., 2018. Determinants of pedestrian and bicyclist
crash severity by party at fault in san francisco, ca. Accident Analysis
and Prevention 110, 149--160.
doi:\href{https://doi.org/10.1016/j.aap.2017.11.007}{10.1016/j.aap.2017.11.007}

\leavevmode\hypertarget{ref-Sasidharan2014partial}{}%
Sasidharan, L., Menendez, M., 2014. Partial proportional odds model-an
alternate choice for analyzing pedestrian crash injury severities.
Accident Analysis and Prevention 72, 330--340.
doi:\href{https://doi.org/10.1016/j.aap.2014.07.025}{10.1016/j.aap.2014.07.025}

\leavevmode\hypertarget{ref-Savolainen2007probabilistic}{}%
Savolainen, P., Mannering, F., 2007. Probabilistic models of
motorcyclists' injury severities in single- and multi-vehicle crashes.
Accident Analysis and Prevention 39, 955--963.
doi:\href{https://doi.org/10.1016/j.aap.2006.12.016}{10.1016/j.aap.2006.12.016}

\leavevmode\hypertarget{ref-Savolainen2011statistical}{}%
Savolainen, P.T., Mannering, F., Lord, D., Quddus, M.A., 2011. The
statistical analysis of highway crash-injury severities: A review and
assessment of methodological alternatives. Accident Analysis and
Prevention 43, 1666--1676.
doi:\href{https://doi.org/10.1016/j.aap.2011.03.025}{10.1016/j.aap.2011.03.025}

\leavevmode\hypertarget{ref-Shaheed2013mixed}{}%
Shaheed, M.S.B., Gkritza, K., Zhang, W., Hans, Z., 2013. A mixed logit
analysis of two-vehicle crash seventies involving a motorcycle. Accident
Analysis and Prevention 61, 119--128.
doi:\href{https://doi.org/10.1016/j.aap.2013.05.028}{10.1016/j.aap.2013.05.028}

\leavevmode\hypertarget{ref-Shamsunnahar2014examining}{}%
Shamsunnahar, Y., Eluru, N., Pinjari, A.R., Tay, R., 2014. Examining
driver injury severity in two vehicle crashes - a copula based approach.
Accident Analysis and Prevention 66, 120--135.
doi:\href{https://doi.org/10.1016/j.aap.2014.01.018}{10.1016/j.aap.2014.01.018}

\leavevmode\hypertarget{ref-Symons2019reduced}{}%
Symons, J., Howard, E., Sweeny, K., Kumnick, M., Sheehan, P., 2019.
Reduced road traffic injuries for young people: A preliminary investment
analysis. Journal of Adolescent Health 65, S34--S43.
doi:\href{https://doi.org/10.1016/j.jadohealth.2019.01.009}{10.1016/j.jadohealth.2019.01.009}

\leavevmode\hypertarget{ref-Tarrao2014modeling}{}%
Tarrao, G.A., Coelho, M.C., Rouphail, N.M., 2014. Modeling the impact of
subject and opponent vehicles on crash severity in two-vehicle
collisions. Transportation Research Record 53--64.
doi:\href{https://doi.org/10.3141/2432-07}{10.3141/2432-07}

\leavevmode\hypertarget{ref-Tay2011multinomial}{}%
Tay, R., Choi, J., Kattan, L., Khan, A., 2011. A multinomial logit model
of pedestrian-vehicle crash severity. International Journal of
Sustainable Transportation 5, 233--249.
doi:\href{https://doi.org/10.1080/15568318.2010.497547}{10.1080/15568318.2010.497547}

\leavevmode\hypertarget{ref-Thompson2018trends}{}%
Thompson, J.P., Baldock, M.R.J., Dutschke, J.K., 2018. Trends in the
crash involvement of older drivers in australia. Accident Analysis and
Prevention 117, 262--269.
doi:\href{https://doi.org/10.1016/j.aap.2018.04.027}{10.1016/j.aap.2018.04.027}

\leavevmode\hypertarget{ref-Train2009discrete}{}%
Train, K., 2009. Discrete choice methods with simulation, 2nd Edition.
ed. Cambridge University Press, Cambridge.

\leavevmode\hypertarget{ref-Wang2015copula}{}%
Wang, K., Yasmin, S., Konduri, K.C., Eluru, N., Ivan, J.N., 2015.
Copula-based joint model of injury severity and vehicle damage in
two-vehicle crashes. Transportation Research Record 158--166.
doi:\href{https://doi.org/10.3141/2514-17}{10.3141/2514-17}

\leavevmode\hypertarget{ref-Wang2005use}{}%
Wang, X.K., Kockelman, K.M., 2005. Use of heteroscedastic ordered logit
model to study severity of occupant injury - distinguishing effects of
vehicle weight and type, in: Statistical Methods; Highway Safety Data,
Analysis, and Evaluation; Occupant Protection; Systematic Reviews and
Meta-Analysis, Transportation Research Record. pp. 195--204.

\leavevmode\hypertarget{ref-White1972effects}{}%
White, S., Clayton, S., 1972. Some effects of alcohol, age of driver,
and estimated speed on the likelihood of driver injury. Accident
Analysis \& Prevention 4.

\leavevmode\hypertarget{ref-Wijnen2019analysis}{}%
Wijnen, W., Weijermars, W., Schoeters, A., Berghe, W. van den, Bauer,
R., Carnis, L., Elvik, R., Martensen, H., 2019. An analysis of official
road crash cost estimates in european countries. Safety Science 113,
318--327.
doi:\href{https://doi.org/10.1016/j.ssci.2018.12.004}{10.1016/j.ssci.2018.12.004}

\leavevmode\hypertarget{ref-WHO2019global}{}%
World Health Organization, 2019. Global status report on road safety
2018 (2018). Geneva.

\leavevmode\hypertarget{ref-Wu2014mixed}{}%
Wu, Q., Chen, F., Zhang, G.H., Liu, X.Y.C., Wang, H., Bogus, S.M., 2014.
Mixed logit model-based driver injury severity investigations in single-
and multi-vehicle crashes on rural two-lane highways. Accident Analysis
and Prevention 72, 105--115.
doi:\href{https://doi.org/10.1016/j.aap.2014.06.014}{10.1016/j.aap.2014.06.014}

\leavevmode\hypertarget{ref-Shamsunnahar2013evaluating}{}%
Yasmin, S., Eluru, N., 2013. Evaluating alternate discrete outcome
frameworks for modeling crash injury severity. Accident Analysis \&
Prevention 59, 506--521.
doi:\href{https://doi.org/https://doi.org/10.1016/j.aap.2013.06.040}{https://doi.org/10.1016/j.aap.2013.06.040}


\end{document}


